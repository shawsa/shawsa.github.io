<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Tangent Plane Method – Sage Shaw</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-9a60b6f365114c3b1e59731f49b17c37.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Sage Shaw</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#verify-distance-function" id="toc-verify-distance-function" class="nav-link active" data-scroll-target="#verify-distance-function">Verify Distance Function</a></li>
  <li><a href="#d-test" id="toc-d-test" class="nav-link" data-scroll-target="#d-test">2D test</a></li>
  <li><a href="#tangent-plane-scaled" id="toc-tangent-plane-scaled" class="nav-link" data-scroll-target="#tangent-plane-scaled">Tangent Plane Scaled</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Tangent Plane Method</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div id="cell-1" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib notebook</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>MEPS <span class="op">=</span> np.finfo(<span class="bu">float</span>).eps</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.linalg <span class="im">as</span> la</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> mpl_toolkits.mplot3d</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.spatial <span class="im">import</span> cKDTree</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.sparse <span class="im">as</span> sp</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.sparse.linalg <span class="im">import</span> spsolve, lsqr</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy.linalg <span class="im">import</span> cond, norm, inv</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os.path</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>warnings.simplefilter(<span class="st">'ignore'</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> minimize_scalar</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> poly_basis <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spherepts <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rbf <span class="im">import</span> <span class="op">*</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-2" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dist_outer2(nodes1, nodes2, W):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    ret <span class="op">=</span> [ [(n1<span class="op">-</span>n2) <span class="op">@</span> W <span class="op">@</span> (n1<span class="op">-</span>n2) <span class="cf">for</span> n1 <span class="kw">in</span> nodes1] <span class="cf">for</span> n2 <span class="kw">in</span> nodes2]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.sqrt(ret)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dist_outer(nodes1, nodes2, W):</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    d <span class="op">=</span> <span class="bu">len</span>(nodes1[<span class="dv">0</span>]) <span class="co"># the dimension of each vector</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    n1 <span class="op">=</span> <span class="bu">len</span>(nodes1)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    n2 <span class="op">=</span> <span class="bu">len</span>(nodes2)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create a row vector of d-dimensional vectors</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    row <span class="op">=</span> nodes1.reshape((<span class="dv">1</span>,n1,d)) </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create a column vector of d-dimensional vectors</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    col <span class="op">=</span> nodes2.reshape((n2,<span class="dv">1</span>,d)) </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    diff <span class="op">=</span> row<span class="op">-</span>col</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    ret <span class="op">=</span> diff <span class="op">@</span> W <span class="op">*</span> diff</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ret = (row-col)**2</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    ret <span class="op">=</span> np.<span class="bu">sum</span>(ret,<span class="dv">2</span>) <span class="co">#sum each d-dimensional vector</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.sqrt(ret)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dist_standard(nodes1, nodes2):</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    d <span class="op">=</span> <span class="bu">len</span>(nodes1[<span class="dv">0</span>]) <span class="co"># the dimension of each vector</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    n1 <span class="op">=</span> <span class="bu">len</span>(nodes1)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    n2 <span class="op">=</span> <span class="bu">len</span>(nodes2)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create a row vector of d dimensional vectors</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    row <span class="op">=</span> nodes1.reshape((<span class="dv">1</span>,n1,d)) </span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create a column vector of d dimensional vectors</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    col <span class="op">=</span> nodes2.reshape((n2,<span class="dv">1</span>,d)) </span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    ret <span class="op">=</span> (row<span class="op">-</span>col)<span class="op">**</span><span class="dv">2</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    ret <span class="op">=</span> np.<span class="bu">sum</span>(ret,<span class="dv">2</span>) <span class="co">#sum each d-dimensional vector</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.sqrt(ret)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-3" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose RBF</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>rbf_obj <span class="op">=</span> rbf_dict[<span class="st">'multiquadric'</span>]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>rbf <span class="op">=</span> rbf_obj[<span class="st">'rbf'</span>]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>zeta  <span class="op">=</span> rbf_obj[<span class="st">'zeta'</span>]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>d2rbf <span class="op">=</span> rbf_obj[<span class="st">'d2rbf'</span>]</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>Lrbf <span class="op">=</span> <span class="kw">lambda</span> r,eps: <span class="dv">1</span><span class="op">*</span>zeta(r,eps) <span class="op">+</span> d2rbf(r,eps)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose solution and forcing fuction</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>solution_index <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>sol_deg <span class="op">=</span> sphere_harm_degs[solution_index]</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>exact <span class="op">=</span> <span class="kw">lambda</span> x: sphere_harm[solution_index](<span class="op">*</span>x)<span class="op">*-</span>sol_deg<span class="op">*</span>(sol_deg<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>forcing <span class="op">=</span> <span class="kw">lambda</span> x: sphere_harm[solution_index](<span class="op">*</span>x)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Harmonic degree: </span><span class="sc">%d</span><span class="st">'</span> <span class="op">%</span> sol_deg)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Harmonic degree: 3</code></pre>
</div>
</div>
<div id="cell-4" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(exact((<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(forcing((<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>-72
6</code></pre>
</div>
</div>
<div id="cell-5" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#eps = .025</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>my_node <span class="op">=</span> n<span class="op">//</span><span class="dv">7</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>nodes <span class="op">=</span> gen_spiral_nodes(n)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>Ws <span class="op">=</span> np.zeros((n, <span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>Rs <span class="op">=</span> np.zeros((n, <span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>e1, e2, e3 <span class="op">=</span> np.eye(<span class="dv">3</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>E <span class="op">=</span> np.eye(<span class="dv">3</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>E[<span class="dv">2</span>,<span class="dv">2</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, node <span class="kw">in</span> <span class="bu">enumerate</span>(nodes):</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    t1 <span class="op">=</span> e2 <span class="op">-</span> np.dot(node, e2)<span class="op">*</span>node</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    t1 <span class="op">/=</span> la.norm(t1)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    t2 <span class="op">=</span> e3 <span class="op">-</span> np.dot(node, e3)<span class="op">*</span>node <span class="op">-</span> np.dot(t1, e3)<span class="op">*</span>t1</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    t2 <span class="op">/=</span> la.norm(t2)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    Rs[i,:,<span class="dv">0</span>] <span class="op">=</span> t1</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    Rs[i,:,<span class="dv">1</span>] <span class="op">=</span> t2</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    Rs[i,:,<span class="dv">2</span>] <span class="op">=</span> node</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Rs[i,0] = t1</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Rs[i,1] = t2</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Rs[i,2] = node</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    Ws[i] <span class="op">=</span> Rs[i] <span class="op">@</span> E <span class="op">@</span> Rs[i].T</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>W <span class="op">=</span> Ws[my_node]</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>R <span class="op">=</span> Rs[my_node]</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>tree <span class="op">=</span> cKDTree(np.array(nodes))</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>stencil <span class="op">=</span> tree.query(nodes[my_node], k)[<span class="dv">1</span>]</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>nn <span class="op">=</span> np.array([nodes[i] <span class="cf">for</span> i <span class="kw">in</span> stencil]) <span class="co">#nodes in the stencil</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-6" class="cell" data-scrolled="false" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">4</span>,<span class="dv">4</span>))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">111</span>, projection<span class="op">=</span><span class="st">'3d'</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>rn <span class="op">=</span> nn <span class="op">@</span> Rs[my_node]</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#rn = np.array([Rs[my_node].T @ node for node in nn])</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#rn = (Rs[my_node].T @ nn.T).T</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>ax.scatter(nn[:,<span class="dv">0</span>], nn[:,<span class="dv">1</span>], nn[:,<span class="dv">2</span>], <span class="st">'.'</span>, color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>ax.scatter(rn[:,<span class="dv">0</span>], rn[:,<span class="dv">1</span>], rn[:,<span class="dv">2</span>], <span class="st">'.'</span>, color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>ax.scatter(nn[<span class="dv">0</span>,<span class="dv">0</span>], nn[<span class="dv">0</span>,<span class="dv">1</span>], nn[<span class="dv">0</span>,<span class="dv">2</span>], <span class="st">'.'</span>, color<span class="op">=</span><span class="st">'r'</span>, s<span class="op">=</span>[<span class="dv">50</span>], marker<span class="op">=</span><span class="st">'x'</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>ax.scatter(rn[<span class="dv">0</span>,<span class="dv">0</span>], rn[<span class="dv">0</span>,<span class="dv">1</span>], rn[<span class="dv">0</span>,<span class="dv">2</span>], <span class="st">'.'</span>, color<span class="op">=</span><span class="st">'g'</span>, s<span class="op">=</span>[<span class="dv">50</span>], marker<span class="op">=</span><span class="st">'x'</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>ax.scatter(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="st">'.'</span>, color<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>ax.set_xlim(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>ax.set_zlim(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<script type="application/javascript">
/* Put everything inside the global mpl namespace */
window.mpl = {};


mpl.get_websocket_type = function() {
    if (typeof(WebSocket) !== 'undefined') {
        return WebSocket;
    } else if (typeof(MozWebSocket) !== 'undefined') {
        return MozWebSocket;
    } else {
        alert('Your browser does not have WebSocket support.' +
              'Please try Chrome, Safari or Firefox ≥ 6. ' +
              'Firefox 4 and 5 are also supported but you ' +
              'have to enable WebSockets in about:config.');
    };
}

mpl.figure = function(figure_id, websocket, ondownload, parent_element) {
    this.id = figure_id;

    this.ws = websocket;

    this.supports_binary = (this.ws.binaryType != undefined);

    if (!this.supports_binary) {
        var warnings = document.getElementById("mpl-warnings");
        if (warnings) {
            warnings.style.display = 'block';
            warnings.textContent = (
                "This browser does not support binary websocket messages. " +
                    "Performance may be slow.");
        }
    }

    this.imageObj = new Image();

    this.context = undefined;
    this.message = undefined;
    this.canvas = undefined;
    this.rubberband_canvas = undefined;
    this.rubberband_context = undefined;
    this.format_dropdown = undefined;

    this.image_mode = 'full';

    this.root = $('<div/>');
    this._root_extra_style(this.root)
    this.root.attr('style', 'display: inline-block');

    $(parent_element).append(this.root);

    this._init_header(this);
    this._init_canvas(this);
    this._init_toolbar(this);

    var fig = this;

    this.waiting = false;

    this.ws.onopen =  function () {
            fig.send_message("supports_binary", {value: fig.supports_binary});
            fig.send_message("send_image_mode", {});
            if (mpl.ratio != 1) {
                fig.send_message("set_dpi_ratio", {'dpi_ratio': mpl.ratio});
            }
            fig.send_message("refresh", {});
        }

    this.imageObj.onload = function() {
            if (fig.image_mode == 'full') {
                // Full images could contain transparency (where diff images
                // almost always do), so we need to clear the canvas so that
                // there is no ghosting.
                fig.context.clearRect(0, 0, fig.canvas.width, fig.canvas.height);
            }
            fig.context.drawImage(fig.imageObj, 0, 0);
        };

    this.imageObj.onunload = function() {
        fig.ws.close();
    }

    this.ws.onmessage = this._make_on_message_function(this);

    this.ondownload = ondownload;
}

mpl.figure.prototype._init_header = function() {
    var titlebar = $(
        '<div class="ui-dialog-titlebar ui-widget-header ui-corner-all ' +
        'ui-helper-clearfix"/>');
    var titletext = $(
        '<div class="ui-dialog-title" style="width: 100%; ' +
        'text-align: center; padding: 3px;"/>');
    titlebar.append(titletext)
    this.root.append(titlebar);
    this.header = titletext[0];
}



mpl.figure.prototype._canvas_extra_style = function(canvas_div) {

}


mpl.figure.prototype._root_extra_style = function(canvas_div) {

}

mpl.figure.prototype._init_canvas = function() {
    var fig = this;

    var canvas_div = $('<div/>');

    canvas_div.attr('style', 'position: relative; clear: both; outline: 0');

    function canvas_keyboard_event(event) {
        return fig.key_event(event, event['data']);
    }

    canvas_div.keydown('key_press', canvas_keyboard_event);
    canvas_div.keyup('key_release', canvas_keyboard_event);
    this.canvas_div = canvas_div
    this._canvas_extra_style(canvas_div)
    this.root.append(canvas_div);

    var canvas = $('<canvas/>');
    canvas.addClass('mpl-canvas');
    canvas.attr('style', "left: 0; top: 0; z-index: 0; outline: 0")

    this.canvas = canvas[0];
    this.context = canvas[0].getContext("2d");

    var backingStore = this.context.backingStorePixelRatio ||
    this.context.webkitBackingStorePixelRatio ||
    this.context.mozBackingStorePixelRatio ||
    this.context.msBackingStorePixelRatio ||
    this.context.oBackingStorePixelRatio ||
    this.context.backingStorePixelRatio || 1;

    mpl.ratio = (window.devicePixelRatio || 1) / backingStore;

    var rubberband = $('<canvas/>');
    rubberband.attr('style', "position: absolute; left: 0; top: 0; z-index: 1;")

    var pass_mouse_events = true;

    canvas_div.resizable({
        start: function(event, ui) {
            pass_mouse_events = false;
        },
        resize: function(event, ui) {
            fig.request_resize(ui.size.width, ui.size.height);
        },
        stop: function(event, ui) {
            pass_mouse_events = true;
            fig.request_resize(ui.size.width, ui.size.height);
        },
    });

    function mouse_event_fn(event) {
        if (pass_mouse_events)
            return fig.mouse_event(event, event['data']);
    }

    rubberband.mousedown('button_press', mouse_event_fn);
    rubberband.mouseup('button_release', mouse_event_fn);
    // Throttle sequential mouse events to 1 every 20ms.
    rubberband.mousemove('motion_notify', mouse_event_fn);

    rubberband.mouseenter('figure_enter', mouse_event_fn);
    rubberband.mouseleave('figure_leave', mouse_event_fn);

    canvas_div.on("wheel", function (event) {
        event = event.originalEvent;
        event['data'] = 'scroll'
        if (event.deltaY < 0) {
            event.step = 1;
        } else {
            event.step = -1;
        }
        mouse_event_fn(event);
    });

    canvas_div.append(canvas);
    canvas_div.append(rubberband);

    this.rubberband = rubberband;
    this.rubberband_canvas = rubberband[0];
    this.rubberband_context = rubberband[0].getContext("2d");
    this.rubberband_context.strokeStyle = "#000000";

    this._resize_canvas = function(width, height) {
        // Keep the size of the canvas, canvas container, and rubber band
        // canvas in synch.
        canvas_div.css('width', width)
        canvas_div.css('height', height)

        canvas.attr('width', width * mpl.ratio);
        canvas.attr('height', height * mpl.ratio);
        canvas.attr('style', 'width: ' + width + 'px; height: ' + height + 'px;');

        rubberband.attr('width', width);
        rubberband.attr('height', height);
    }

    // Set the figure to an initial 600x600px, this will subsequently be updated
    // upon first draw.
    this._resize_canvas(600, 600);

    // Disable right mouse context menu.
    $(this.rubberband_canvas).bind("contextmenu",function(e){
        return false;
    });

    function set_focus () {
        canvas.focus();
        canvas_div.focus();
    }

    window.setTimeout(set_focus, 100);
}

mpl.figure.prototype._init_toolbar = function() {
    var fig = this;

    var nav_element = $('<div/>')
    nav_element.attr('style', 'width: 100%');
    this.root.append(nav_element);

    // Define a callback function for later on.
    function toolbar_event(event) {
        return fig.toolbar_button_onclick(event['data']);
    }
    function toolbar_mouse_event(event) {
        return fig.toolbar_button_onmouseover(event['data']);
    }

    for(var toolbar_ind in mpl.toolbar_items) {
        var name = mpl.toolbar_items[toolbar_ind][0];
        var tooltip = mpl.toolbar_items[toolbar_ind][1];
        var image = mpl.toolbar_items[toolbar_ind][2];
        var method_name = mpl.toolbar_items[toolbar_ind][3];

        if (!name) {
            // put a spacer in here.
            continue;
        }
        var button = $('<button/>');
        button.addClass('ui-button ui-widget ui-state-default ui-corner-all ' +
                        'ui-button-icon-only');
        button.attr('role', 'button');
        button.attr('aria-disabled', 'false');
        button.click(method_name, toolbar_event);
        button.mouseover(tooltip, toolbar_mouse_event);

        var icon_img = $('<span/>');
        icon_img.addClass('ui-button-icon-primary ui-icon');
        icon_img.addClass(image);
        icon_img.addClass('ui-corner-all');

        var tooltip_span = $('<span/>');
        tooltip_span.addClass('ui-button-text');
        tooltip_span.html(tooltip);

        button.append(icon_img);
        button.append(tooltip_span);

        nav_element.append(button);
    }

    var fmt_picker_span = $('<span/>');

    var fmt_picker = $('<select/>');
    fmt_picker.addClass('mpl-toolbar-option ui-widget ui-widget-content');
    fmt_picker_span.append(fmt_picker);
    nav_element.append(fmt_picker_span);
    this.format_dropdown = fmt_picker[0];

    for (var ind in mpl.extensions) {
        var fmt = mpl.extensions[ind];
        var option = $(
            '<option/>', {selected: fmt === mpl.default_extension}).html(fmt);
        fmt_picker.append(option)
    }

    // Add hover states to the ui-buttons
    $( ".ui-button" ).hover(
        function() { $(this).addClass("ui-state-hover");},
        function() { $(this).removeClass("ui-state-hover");}
    );

    var status_bar = $('<span class="mpl-message"/>');
    nav_element.append(status_bar);
    this.message = status_bar[0];
}

mpl.figure.prototype.request_resize = function(x_pixels, y_pixels) {
    // Request matplotlib to resize the figure. Matplotlib will then trigger a resize in the client,
    // which will in turn request a refresh of the image.
    this.send_message('resize', {'width': x_pixels, 'height': y_pixels});
}

mpl.figure.prototype.send_message = function(type, properties) {
    properties['type'] = type;
    properties['figure_id'] = this.id;
    this.ws.send(JSON.stringify(properties));
}

mpl.figure.prototype.send_draw_message = function() {
    if (!this.waiting) {
        this.waiting = true;
        this.ws.send(JSON.stringify({type: "draw", figure_id: this.id}));
    }
}


mpl.figure.prototype.handle_save = function(fig, msg) {
    var format_dropdown = fig.format_dropdown;
    var format = format_dropdown.options[format_dropdown.selectedIndex].value;
    fig.ondownload(fig, format);
}


mpl.figure.prototype.handle_resize = function(fig, msg) {
    var size = msg['size'];
    if (size[0] != fig.canvas.width || size[1] != fig.canvas.height) {
        fig._resize_canvas(size[0], size[1]);
        fig.send_message("refresh", {});
    };
}

mpl.figure.prototype.handle_rubberband = function(fig, msg) {
    var x0 = msg['x0'] / mpl.ratio;
    var y0 = (fig.canvas.height - msg['y0']) / mpl.ratio;
    var x1 = msg['x1'] / mpl.ratio;
    var y1 = (fig.canvas.height - msg['y1']) / mpl.ratio;
    x0 = Math.floor(x0) + 0.5;
    y0 = Math.floor(y0) + 0.5;
    x1 = Math.floor(x1) + 0.5;
    y1 = Math.floor(y1) + 0.5;
    var min_x = Math.min(x0, x1);
    var min_y = Math.min(y0, y1);
    var width = Math.abs(x1 - x0);
    var height = Math.abs(y1 - y0);

    fig.rubberband_context.clearRect(
        0, 0, fig.canvas.width, fig.canvas.height);

    fig.rubberband_context.strokeRect(min_x, min_y, width, height);
}

mpl.figure.prototype.handle_figure_label = function(fig, msg) {
    // Updates the figure title.
    fig.header.textContent = msg['label'];
}

mpl.figure.prototype.handle_cursor = function(fig, msg) {
    var cursor = msg['cursor'];
    switch(cursor)
    {
    case 0:
        cursor = 'pointer';
        break;
    case 1:
        cursor = 'default';
        break;
    case 2:
        cursor = 'crosshair';
        break;
    case 3:
        cursor = 'move';
        break;
    }
    fig.rubberband_canvas.style.cursor = cursor;
}

mpl.figure.prototype.handle_message = function(fig, msg) {
    fig.message.textContent = msg['message'];
}

mpl.figure.prototype.handle_draw = function(fig, msg) {
    // Request the server to send over a new figure.
    fig.send_draw_message();
}

mpl.figure.prototype.handle_image_mode = function(fig, msg) {
    fig.image_mode = msg['mode'];
}

mpl.figure.prototype.updated_canvas_event = function() {
    // Called whenever the canvas gets updated.
    this.send_message("ack", {});
}

// A function to construct a web socket function for onmessage handling.
// Called in the figure constructor.
mpl.figure.prototype._make_on_message_function = function(fig) {
    return function socket_on_message(evt) {
        if (evt.data instanceof Blob) {
            /* FIXME: We get "Resource interpreted as Image but
             * transferred with MIME type text/plain:" errors on
             * Chrome.  But how to set the MIME type?  It doesn't seem
             * to be part of the websocket stream */
            evt.data.type = "image/png";

            /* Free the memory for the previous frames */
            if (fig.imageObj.src) {
                (window.URL || window.webkitURL).revokeObjectURL(
                    fig.imageObj.src);
            }

            fig.imageObj.src = (window.URL || window.webkitURL).createObjectURL(
                evt.data);
            fig.updated_canvas_event();
            fig.waiting = false;
            return;
        }
        else if (typeof evt.data === 'string' && evt.data.slice(0, 21) == "data:image/png;base64") {
            fig.imageObj.src = evt.data;
            fig.updated_canvas_event();
            fig.waiting = false;
            return;
        }

        var msg = JSON.parse(evt.data);
        var msg_type = msg['type'];

        // Call the  "handle_{type}" callback, which takes
        // the figure and JSON message as its only arguments.
        try {
            var callback = fig["handle_" + msg_type];
        } catch (e) {
            console.log("No handler for the '" + msg_type + "' message type: ", msg);
            return;
        }

        if (callback) {
            try {
                // console.log("Handling '" + msg_type + "' message: ", msg);
                callback(fig, msg);
            } catch (e) {
                console.log("Exception inside the 'handler_" + msg_type + "' callback:", e, e.stack, msg);
            }
        }
    };
}

// from http://stackoverflow.com/questions/1114465/getting-mouse-location-in-canvas
mpl.findpos = function(e) {
    //this section is from http://www.quirksmode.org/js/events_properties.html
    var targ;
    if (!e)
        e = window.event;
    if (e.target)
        targ = e.target;
    else if (e.srcElement)
        targ = e.srcElement;
    if (targ.nodeType == 3) // defeat Safari bug
        targ = targ.parentNode;

    // jQuery normalizes the pageX and pageY
    // pageX,Y are the mouse positions relative to the document
    // offset() returns the position of the element relative to the document
    var x = e.pageX - $(targ).offset().left;
    var y = e.pageY - $(targ).offset().top;

    return {"x": x, "y": y};
};

/*
 * return a copy of an object with only non-object keys
 * we need this to avoid circular references
 * http://stackoverflow.com/a/24161582/3208463
 */
function simpleKeys (original) {
  return Object.keys(original).reduce(function (obj, key) {
    if (typeof original[key] !== 'object')
        obj[key] = original[key]
    return obj;
  }, {});
}

mpl.figure.prototype.mouse_event = function(event, name) {
    var canvas_pos = mpl.findpos(event)

    if (name === 'button_press')
    {
        this.canvas.focus();
        this.canvas_div.focus();
    }

    var x = canvas_pos.x * mpl.ratio;
    var y = canvas_pos.y * mpl.ratio;

    this.send_message(name, {x: x, y: y, button: event.button,
                             step: event.step,
                             guiEvent: simpleKeys(event)});

    /* This prevents the web browser from automatically changing to
     * the text insertion cursor when the button is pressed.  We want
     * to control all of the cursor setting manually through the
     * 'cursor' event from matplotlib */
    event.preventDefault();
    return false;
}

mpl.figure.prototype._key_event_extra = function(event, name) {
    // Handle any extra behaviour associated with a key event
}

mpl.figure.prototype.key_event = function(event, name) {

    // Prevent repeat events
    if (name == 'key_press')
    {
        if (event.which === this._key)
            return;
        else
            this._key = event.which;
    }
    if (name == 'key_release')
        this._key = null;

    var value = '';
    if (event.ctrlKey && event.which != 17)
        value += "ctrl+";
    if (event.altKey && event.which != 18)
        value += "alt+";
    if (event.shiftKey && event.which != 16)
        value += "shift+";

    value += 'k';
    value += event.which.toString();

    this._key_event_extra(event, name);

    this.send_message(name, {key: value,
                             guiEvent: simpleKeys(event)});
    return false;
}

mpl.figure.prototype.toolbar_button_onclick = function(name) {
    if (name == 'download') {
        this.handle_save(this, null);
    } else {
        this.send_message("toolbar_button", {name: name});
    }
};

mpl.figure.prototype.toolbar_button_onmouseover = function(tooltip) {
    this.message.textContent = tooltip;
};
mpl.toolbar_items = [["Home", "Reset original view", "fa fa-home icon-home", "home"], ["Back", "Back to  previous view", "fa fa-arrow-left icon-arrow-left", "back"], ["Forward", "Forward to next view", "fa fa-arrow-right icon-arrow-right", "forward"], ["", "", "", ""], ["Pan", "Pan axes with left mouse, zoom with right", "fa fa-arrows icon-move", "pan"], ["Zoom", "Zoom to rectangle", "fa fa-square-o icon-check-empty", "zoom"], ["", "", "", ""], ["Download", "Download plot", "fa fa-floppy-o icon-save", "download"]];

mpl.extensions = ["eps", "jpeg", "pdf", "png", "ps", "raw", "svg", "tif"];

mpl.default_extension = "png";var comm_websocket_adapter = function(comm) {
    // Create a "websocket"-like object which calls the given IPython comm
    // object with the appropriate methods. Currently this is a non binary
    // socket, so there is still some room for performance tuning.
    var ws = {};

    ws.close = function() {
        comm.close()
    };
    ws.send = function(m) {
        //console.log('sending', m);
        comm.send(m);
    };
    // Register the callback with on_msg.
    comm.on_msg(function(msg) {
        //console.log('receiving', msg['content']['data'], msg);
        // Pass the mpl event to the overridden (by mpl) onmessage function.
        ws.onmessage(msg['content']['data'])
    });
    return ws;
}

mpl.mpl_figure_comm = function(comm, msg) {
    // This is the function which gets called when the mpl process
    // starts-up an IPython Comm through the "matplotlib" channel.

    var id = msg.content.data.id;
    // Get hold of the div created by the display call when the Comm
    // socket was opened in Python.
    var element = $("#" + id);
    var ws_proxy = comm_websocket_adapter(comm)

    function ondownload(figure, format) {
        window.open(figure.imageObj.src);
    }

    var fig = new mpl.figure(id, ws_proxy,
                           ondownload,
                           element.get(0));

    // Call onopen now - mpl needs it, as it is assuming we've passed it a real
    // web socket which is closed, not our websocket->open comm proxy.
    ws_proxy.onopen();

    fig.parent_element = element.get(0);
    fig.cell_info = mpl.find_output_cell("<div id='" + id + "'></div>");
    if (!fig.cell_info) {
        console.error("Failed to find cell for figure", id, fig);
        return;
    }

    var output_index = fig.cell_info[2]
    var cell = fig.cell_info[0];

};

mpl.figure.prototype.handle_close = function(fig, msg) {
    var width = fig.canvas.width/mpl.ratio
    fig.root.unbind('remove')

    // Update the output cell to use the data from the current canvas.
    fig.push_to_output();
    var dataURL = fig.canvas.toDataURL();
    // Re-enable the keyboard manager in IPython - without this line, in FF,
    // the notebook keyboard shortcuts fail.
    IPython.keyboard_manager.enable()
    $(fig.parent_element).html('<img src="' + dataURL + '" width="' + width + '">');
    fig.close_ws(fig, msg);
}

mpl.figure.prototype.close_ws = function(fig, msg){
    fig.send_message('closing', msg);
    // fig.ws.close()
}

mpl.figure.prototype.push_to_output = function(remove_interactive) {
    // Turn the data on the canvas into data in the output cell.
    var width = this.canvas.width/mpl.ratio
    var dataURL = this.canvas.toDataURL();
    this.cell_info[1]['text/html'] = '<img src="' + dataURL + '" width="' + width + '">';
}

mpl.figure.prototype.updated_canvas_event = function() {
    // Tell IPython that the notebook contents must change.
    IPython.notebook.set_dirty(true);
    this.send_message("ack", {});
    var fig = this;
    // Wait a second, then push the new image to the DOM so
    // that it is saved nicely (might be nice to debounce this).
    setTimeout(function () { fig.push_to_output() }, 1000);
}

mpl.figure.prototype._init_toolbar = function() {
    var fig = this;

    var nav_element = $('<div/>')
    nav_element.attr('style', 'width: 100%');
    this.root.append(nav_element);

    // Define a callback function for later on.
    function toolbar_event(event) {
        return fig.toolbar_button_onclick(event['data']);
    }
    function toolbar_mouse_event(event) {
        return fig.toolbar_button_onmouseover(event['data']);
    }

    for(var toolbar_ind in mpl.toolbar_items){
        var name = mpl.toolbar_items[toolbar_ind][0];
        var tooltip = mpl.toolbar_items[toolbar_ind][1];
        var image = mpl.toolbar_items[toolbar_ind][2];
        var method_name = mpl.toolbar_items[toolbar_ind][3];

        if (!name) { continue; };

        var button = $('<button class="btn btn-default" href="#" title="' + name + '"><i class="fa ' + image + ' fa-lg"></i></button>');
        button.click(method_name, toolbar_event);
        button.mouseover(tooltip, toolbar_mouse_event);
        nav_element.append(button);
    }

    // Add the status bar.
    var status_bar = $('<span class="mpl-message" style="text-align:right; float: right;"/>');
    nav_element.append(status_bar);
    this.message = status_bar[0];

    // Add the close button to the window.
    var buttongrp = $('<div class="btn-group inline pull-right"></div>');
    var button = $('<button class="btn btn-mini btn-primary" href="#" title="Stop Interaction"><i class="fa fa-power-off icon-remove icon-large"></i></button>');
    button.click(function (evt) { fig.handle_close(fig, {}); } );
    button.mouseover('Stop Interaction', toolbar_mouse_event);
    buttongrp.append(button);
    var titlebar = this.root.find($('.ui-dialog-titlebar'));
    titlebar.prepend(buttongrp);
}

mpl.figure.prototype._root_extra_style = function(el){
    var fig = this
    el.on("remove", function(){
    fig.close_ws(fig, {});
    });
}

mpl.figure.prototype._canvas_extra_style = function(el){
    // this is important to make the div 'focusable
    el.attr('tabindex', 0)
    // reach out to IPython and tell the keyboard manager to turn it's self
    // off when our div gets focus

    // location in version 3
    if (IPython.notebook.keyboard_manager) {
        IPython.notebook.keyboard_manager.register_events(el);
    }
    else {
        // location in version 2
        IPython.keyboard_manager.register_events(el);
    }

}

mpl.figure.prototype._key_event_extra = function(event, name) {
    var manager = IPython.notebook.keyboard_manager;
    if (!manager)
        manager = IPython.keyboard_manager;

    // Check for shift+enter
    if (event.shiftKey && event.which == 13) {
        this.canvas_div.blur();
        event.shiftKey = false;
        // Send a "J" for go to next cell
        event.which = 74;
        event.keyCode = 74;
        manager.command_mode();
        manager.handle_keydown(event);
    }
}

mpl.figure.prototype.handle_save = function(fig, msg) {
    fig.ondownload(fig, null);
}


mpl.find_output_cell = function(html_output) {
    // Return the cell and output element which can be found *uniquely* in the notebook.
    // Note - this is a bit hacky, but it is done because the "notebook_saving.Notebook"
    // IPython event is triggered only after the cells have been serialised, which for
    // our purposes (turning an active figure into a static one), is too late.
    var cells = IPython.notebook.get_cells();
    var ncells = cells.length;
    for (var i=0; i<ncells; i++) {
        var cell = cells[i];
        if (cell.cell_type === 'code'){
            for (var j=0; j<cell.output_area.outputs.length; j++) {
                var data = cell.output_area.outputs[j];
                if (data.data) {
                    // IPython >= 3 moved mimebundle to data attribute of output
                    data = data.data;
                }
                if (data['text/html'] == html_output) {
                    return [cell, data, j];
                }
            }
        }
    }
}

// Register the function which deals with the matplotlib target/channel.
// The kernel may be null if the page has been refreshed.
if (IPython.notebook.kernel != null) {
    IPython.notebook.kernel.comm_manager.register_target('matplotlib', mpl.mpl_figure_comm);
}

</script>
</div>
<div class="cell-output cell-output-display">
<img src="data:image/png;base64,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cccdqzPOOKMkE7z22muLa2q68Q53cmUqneGOXZueJ4G0QS3vWRQBLrwRSMgdVx4ukomm8qFMsRL8RRMnIu9WBBKeddZZGUiY8ysRGAgCSSADGajsZiKQCCQC84ZAEsi8jUj2JxFIBBKBgSCQBDKQgcputkdgkvxc1GsHH3zwE14mPYiKgdkSgUTgiQgkgeSMWNEITJqfC4F86EMfKvm7okkZwgkgWyKQCCSB5BxYRQhMmp8LgRxzzDHV3/72t1WEUn5qItAOgZRA2uGWdw0AgTbBjQjk0EMPLe7G4lhe85rXFNfiLbfccgBfnF1MBPpFIAmkX7zzbT0i0Ca9ygMPPFD95je/KcGMqv2dffbZ1caNG6uHH3641InPlggkAv8fgSSQnA0rFoE2BDIKxr///e/q5S9/eUn4eOqpp65YrPLDEoE2CCSBtEEt7xkEAm1UWAt92F577VU96UlPqq655ppBfHd2MhHoC4EkkL6QzvfMBIFJ83ONdvI///lPsX8os3vOOefM5BvypYnAvCKQBDKvI5P96gSBSfNznXLKKZWqiC95yUuKJ5a0LDfddFP14IMPVq94xSs66dO8POT000+vNmzYUD300EOV2ixNPM+U1P3kJz9ZrV+/vly/7bbbljrs6tlnW30IJIGsvjFfdV88SX6uY489trrhhhuqxx9/vHr6059evfa1r61OO+206tWvfvWKww0R/M///E/1pz/9qbrkMfG09QAABKVJREFUkksaEYia9ZJhKgT2whe+sPr4xz9e/eIXv6h+9atfVU9+8pNXHEb5QUsjkASSMyQRWOUINI19IX1sttlm1bp166rjjz++oMZTTZClZ+y9996rHMnV9/lJIKtvzPOLE4EnINCUQH77299WL37xi6uf/exnlUzL0aTk9+9zzz03kV1lCCSBrLIBz89NBEYRaEog6reweXCPfvazn73pMWvXrq2ke2Fvyra6EEgCWV3jnV87BwgITGScZ5h/7LHHqhtvvLHaY489luzZfffdVx133HEloPF5z3teqaFy0EEH/dc9Kj+yUyzVlJ592ctetumSJJA5mBQD7UISyEAHLrs9XARuu+226v777y8G+ne+851jCeR3v/td9cpXvrI6/PDDS5qVe+65p+Tr4kG18847PwGIv/zlL9Vf//rXJcF50YteVLyuojUlkFRhDXfOTavnSSDTQjafmwg0QIDqZ5wEcuKJJxay+OUvf7npiQzW3Ghvv/32Bm9Z+pKmBBJGdAZ0hnTt73//e/XMZz4zjejLHoVhPiAJZJjjlr1eIQg0IZAddtihJHVUYz7apZdeWqQQXlBt2x//+MdKDfObb765qNS+973vlUeJgXnqU59a/puqi9vunnvuWf5NPaaGfd2N9+c//3m68bYdhIHflwQy8AHM7g8bgSYEssUWW5QiVyeddNKmj7311lur3XffvfrnP/9ZPeUpT2kFAhsKIhht3/nOd0r9ek3/kFXYWyKQ8Mtf/nKRgLbbbrvqoosuqvQx2+pDIAlk9Y15fvEcITBLApkjGLIrA0UgCWSgA5fdXhkINCGQaamwVgaC+RWzRCAJZJbo57tXPQJNCIQRncpKypBo++67b7FfdGFEX/WDkAC0RiAJpDV0eWMi0A6Bf/zjH9UjjzxSbpZjS5bfN7zhDdUznvGM6vnPf36xdTz66KPVFVdcUa4JN94PfOAD1SGHHFLde++91dFHH72gG2+7HuVdiUA7BJJA2uGWdyUCrREQFIgwRtuBBx5Y3GEZrH//+99XrovmvyV6lLRQZURJDBcKJGzdqbwxEWiBQBJIC9DylkQgEUgEEoGqSgLJWZAIJAKJQCLQCoEkkFaw5U2JQCKQCCQCSSA5BxKBRCARSARaIZAE0gq2vCkRSAQSgUQgCSTnQCKQCCQCiUArBJJAWsGWNyUCiUAikAgkgeQcSAQSgUQgEWiFQBJIK9jypkQgEUgEEoEkkJwDiUAikAgkAq0QSAJpBVvelAgkAolAIpAEknMgEUgEEoFEoBUCSSCtYMubEoFEIBFIBJJAcg4kAolAIpAItEIgCaQVbHlTIpAIJAKJQBJIzoFEIBFIBBKBVggkgbSCLW9KBBKBRCARSALJOZAIJAKJQCLQCoEkkFaw5U2JQCKQCCQCSSA5BxKBRCARSARaIZAE0gq2vCkRSAQSgUQgCSTnQCKQCCQCiUArBJJAWsGWNyUCiUAikAgkgeQcSAQSgUQgEWiFQBJIK9jypkQgEUgEEoEkkJwDiUAikAgkAq0QSAJpBVvelAgkAolAIpAEknMgEUgEEoFEoBUCSSCtYMubEoFEIBFIBP4veHAk0v0L5YMAAAAASUVORK5CYII=" width="400">
</div>
</div>
<div id="cell-7" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>nodes[my_node]<span class="op">@</span> Rs[my_node]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>array([0., 0., 1.])</code></pre>
</div>
</div>
<div id="cell-9" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>eps <span class="op">=</span> <span class="fl">.25</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> rbf(dist_outer(nn, nn, W), eps)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'cond(A) = </span><span class="sc">%g</span><span class="ch">\n</span><span class="st">'</span> <span class="op">%</span> la.cond(A))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>rhs <span class="op">=</span> Lrbf(dist_outer(nn,nn[<span class="dv">0</span>].reshape((<span class="dv">1</span>,<span class="dv">3</span>)), W), eps)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">#rhs = Lrbf(dist_outer(nn[0].reshape((1,3)), nn, W), eps)</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>ws <span class="op">=</span> la.solve(A, rhs.flatten())</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">#ws = la.solve(A, rhs)</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>L_approx <span class="op">=</span> np.dot(ws, [forcing(node) <span class="cf">for</span> node <span class="kw">in</span> nn])</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>L_actual <span class="op">=</span> exact(nn[<span class="dv">0</span>])</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Approximated Laplacian = </span><span class="sc">%g</span><span class="st">'</span> <span class="op">%</span> L_approx)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Actual Laplacian = </span><span class="sc">%g</span><span class="ch">\n</span><span class="st">'</span> <span class="op">%</span> L_actual)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Relative error = </span><span class="sc">%g</span><span class="st">'</span> <span class="op">%</span> np.<span class="bu">abs</span>((L_approx <span class="op">-</span> L_actual)<span class="op">/</span>L_actual))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>cond(A) = 1.88581e+12

Approximated Laplacian = -2.08347
Actual Laplacian = -2.07673

Relative error = 0.00324521</code></pre>
</div>
</div>
<div id="cell-10" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ws</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>array([-7.47243038e+01,  1.92785626e+01,  1.91979670e+01,  1.48717837e+01,
        1.50395920e+01,  9.15152827e+00, -5.63612079e-01,  1.03858199e+00,
        1.12495464e+00,  1.36560027e+00, -1.40217919e+00, -2.99377165e-01,
       -1.38757561e+00, -4.42762301e-01,  4.89656885e-02, -3.00679640e-01,
       -6.90779897e-01, -1.72473901e-01, -5.85096612e-01, -5.48689703e-01])</code></pre>
</div>
</div>
<div id="cell-11" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>W</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>array([[ 0.72184301, -0.24204312, -0.37709522],
       [-0.24204312,  0.78938199, -0.32813593],
       [-0.37709522, -0.32813593,  0.488775  ]])</code></pre>
</div>
</div>
<div id="cell-12" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>e1, e2, e3 <span class="op">=</span> np.eye(<span class="dv">3</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(e1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1. 0. 0.]</code></pre>
</div>
</div>
<div id="cell-13" class="cell" data-execution_count="27">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>dist_mat <span class="op">=</span> dist_outer(nn,nn, W)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>dist_vec <span class="op">=</span> dist_outer(nn,nn[<span class="dv">0</span>].reshape((<span class="dv">1</span>,<span class="dv">3</span>)), W)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dist_mat[<span class="dv">0</span>])</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dist_vec.flatten())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="verify-distance-function" class="level1">
<h1>Verify Distance Function</h1>
<div id="cell-15" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>my_dist <span class="op">=</span> dist_outer(nn,nn,W)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>proj_nodes <span class="op">=</span> (nn <span class="op">@</span> R)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(proj_nodes[:<span class="dv">3</span>])</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>proj_nodes <span class="op">=</span> proj_nodes[:,:<span class="dv">2</span>]</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>proj_dist <span class="op">=</span> dist_outer(proj_nodes, proj_nodes, np.eye(<span class="dv">2</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 0.          0.          1.        ]
 [ 0.23099884 -0.04162858  0.97206306]
 [-0.21229879  0.12386331  0.96932301]]</code></pre>
</div>
</div>
<div id="cell-16" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.allclose(proj_dist[:<span class="dv">5</span>, :<span class="dv">5</span>],my_dist[:<span class="dv">5</span>, :<span class="dv">5</span>]))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(my_dist[:<span class="dv">5</span>, :<span class="dv">5</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>True
[[0.         0.23471984 0.24579035 0.25558374 0.27537935]
 [0.23471984 0.         0.47318111 0.30765017 0.44682631]
 [0.24579035 0.47318111 0.         0.33018901 0.32853915]
 [0.25558374 0.30765017 0.33018901 0.         0.52313587]
 [0.27537935 0.44682631 0.32853915 0.52313587 0.        ]]</code></pre>
</div>
</div>
<div id="cell-17" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>nn[<span class="dv">0</span>].reshape((<span class="dv">1</span>,<span class="dv">3</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>array([[0.52740591, 0.45893138, 0.715     ]])</code></pre>
</div>
</div>
<div id="cell-18" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>np.allclose(dist_outer(nn,nn,np.eye(<span class="dv">3</span>)),dist_standard(nn,nn))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>True</code></pre>
</div>
</div>
</section>
<section id="d-test" class="level1">
<h1>2D test</h1>
<div id="cell-20" class="cell" data-execution_count="21">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> <span class="fl">.005</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>eps <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>num <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>ts <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">2</span><span class="op">*</span>np.pi, num, endpoint<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co">#hs = np.array([h/5*(-1)**i + h for i in range(num)])</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>hs<span class="op">=</span> [h]<span class="op">*</span>num</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>nodes <span class="op">=</span> np.zeros((num<span class="op">+</span><span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>nodes[<span class="dv">1</span>:,<span class="dv">0</span>] <span class="op">=</span> np.cos(ts)<span class="op">*</span>hs</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>nodes[<span class="dv">1</span>:,<span class="dv">1</span>] <span class="op">=</span> np.sin(ts)<span class="op">*</span>hs</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="co">'''</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co">nodes[0] = (0,0)</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="co">nodes[1] = (0,h)</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co">nodes[2] = (0,-h)</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="co">nodes[3] = (h,0)</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co">nodes[4] = (-h,-h/2)</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="co">'''</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">4</span>,<span class="dv">4</span>))</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>plt.plot(nodes[:,<span class="dv">0</span>], nodes[:,<span class="dv">1</span>], <span class="st">'ro'</span>)</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> rbf(dist_outer(nodes, nodes, W<span class="op">=</span>np.eye(<span class="dv">2</span>)), eps)</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'cond(A)=</span><span class="sc">%g</span><span class="st">'</span> <span class="op">%</span> la.cond(A))</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>rhs <span class="op">=</span> Lrbf(dist_outer(nodes[<span class="dv">0</span>].reshape((<span class="dv">1</span>,<span class="dv">2</span>)), nodes, W<span class="op">=</span>np.eye(<span class="dv">2</span>)), eps)</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>ws <span class="op">=</span> la.solve(A ,rhs)</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ws)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<script type="application/javascript">
/* Put everything inside the global mpl namespace */
window.mpl = {};


mpl.get_websocket_type = function() {
    if (typeof(WebSocket) !== 'undefined') {
        return WebSocket;
    } else if (typeof(MozWebSocket) !== 'undefined') {
        return MozWebSocket;
    } else {
        alert('Your browser does not have WebSocket support.' +
              'Please try Chrome, Safari or Firefox ≥ 6. ' +
              'Firefox 4 and 5 are also supported but you ' +
              'have to enable WebSockets in about:config.');
    };
}

mpl.figure = function(figure_id, websocket, ondownload, parent_element) {
    this.id = figure_id;

    this.ws = websocket;

    this.supports_binary = (this.ws.binaryType != undefined);

    if (!this.supports_binary) {
        var warnings = document.getElementById("mpl-warnings");
        if (warnings) {
            warnings.style.display = 'block';
            warnings.textContent = (
                "This browser does not support binary websocket messages. " +
                    "Performance may be slow.");
        }
    }

    this.imageObj = new Image();

    this.context = undefined;
    this.message = undefined;
    this.canvas = undefined;
    this.rubberband_canvas = undefined;
    this.rubberband_context = undefined;
    this.format_dropdown = undefined;

    this.image_mode = 'full';

    this.root = $('<div/>');
    this._root_extra_style(this.root)
    this.root.attr('style', 'display: inline-block');

    $(parent_element).append(this.root);

    this._init_header(this);
    this._init_canvas(this);
    this._init_toolbar(this);

    var fig = this;

    this.waiting = false;

    this.ws.onopen =  function () {
            fig.send_message("supports_binary", {value: fig.supports_binary});
            fig.send_message("send_image_mode", {});
            if (mpl.ratio != 1) {
                fig.send_message("set_dpi_ratio", {'dpi_ratio': mpl.ratio});
            }
            fig.send_message("refresh", {});
        }

    this.imageObj.onload = function() {
            if (fig.image_mode == 'full') {
                // Full images could contain transparency (where diff images
                // almost always do), so we need to clear the canvas so that
                // there is no ghosting.
                fig.context.clearRect(0, 0, fig.canvas.width, fig.canvas.height);
            }
            fig.context.drawImage(fig.imageObj, 0, 0);
        };

    this.imageObj.onunload = function() {
        fig.ws.close();
    }

    this.ws.onmessage = this._make_on_message_function(this);

    this.ondownload = ondownload;
}

mpl.figure.prototype._init_header = function() {
    var titlebar = $(
        '<div class="ui-dialog-titlebar ui-widget-header ui-corner-all ' +
        'ui-helper-clearfix"/>');
    var titletext = $(
        '<div class="ui-dialog-title" style="width: 100%; ' +
        'text-align: center; padding: 3px;"/>');
    titlebar.append(titletext)
    this.root.append(titlebar);
    this.header = titletext[0];
}



mpl.figure.prototype._canvas_extra_style = function(canvas_div) {

}


mpl.figure.prototype._root_extra_style = function(canvas_div) {

}

mpl.figure.prototype._init_canvas = function() {
    var fig = this;

    var canvas_div = $('<div/>');

    canvas_div.attr('style', 'position: relative; clear: both; outline: 0');

    function canvas_keyboard_event(event) {
        return fig.key_event(event, event['data']);
    }

    canvas_div.keydown('key_press', canvas_keyboard_event);
    canvas_div.keyup('key_release', canvas_keyboard_event);
    this.canvas_div = canvas_div
    this._canvas_extra_style(canvas_div)
    this.root.append(canvas_div);

    var canvas = $('<canvas/>');
    canvas.addClass('mpl-canvas');
    canvas.attr('style', "left: 0; top: 0; z-index: 0; outline: 0")

    this.canvas = canvas[0];
    this.context = canvas[0].getContext("2d");

    var backingStore = this.context.backingStorePixelRatio ||
    this.context.webkitBackingStorePixelRatio ||
    this.context.mozBackingStorePixelRatio ||
    this.context.msBackingStorePixelRatio ||
    this.context.oBackingStorePixelRatio ||
    this.context.backingStorePixelRatio || 1;

    mpl.ratio = (window.devicePixelRatio || 1) / backingStore;

    var rubberband = $('<canvas/>');
    rubberband.attr('style', "position: absolute; left: 0; top: 0; z-index: 1;")

    var pass_mouse_events = true;

    canvas_div.resizable({
        start: function(event, ui) {
            pass_mouse_events = false;
        },
        resize: function(event, ui) {
            fig.request_resize(ui.size.width, ui.size.height);
        },
        stop: function(event, ui) {
            pass_mouse_events = true;
            fig.request_resize(ui.size.width, ui.size.height);
        },
    });

    function mouse_event_fn(event) {
        if (pass_mouse_events)
            return fig.mouse_event(event, event['data']);
    }

    rubberband.mousedown('button_press', mouse_event_fn);
    rubberband.mouseup('button_release', mouse_event_fn);
    // Throttle sequential mouse events to 1 every 20ms.
    rubberband.mousemove('motion_notify', mouse_event_fn);

    rubberband.mouseenter('figure_enter', mouse_event_fn);
    rubberband.mouseleave('figure_leave', mouse_event_fn);

    canvas_div.on("wheel", function (event) {
        event = event.originalEvent;
        event['data'] = 'scroll'
        if (event.deltaY < 0) {
            event.step = 1;
        } else {
            event.step = -1;
        }
        mouse_event_fn(event);
    });

    canvas_div.append(canvas);
    canvas_div.append(rubberband);

    this.rubberband = rubberband;
    this.rubberband_canvas = rubberband[0];
    this.rubberband_context = rubberband[0].getContext("2d");
    this.rubberband_context.strokeStyle = "#000000";

    this._resize_canvas = function(width, height) {
        // Keep the size of the canvas, canvas container, and rubber band
        // canvas in synch.
        canvas_div.css('width', width)
        canvas_div.css('height', height)

        canvas.attr('width', width * mpl.ratio);
        canvas.attr('height', height * mpl.ratio);
        canvas.attr('style', 'width: ' + width + 'px; height: ' + height + 'px;');

        rubberband.attr('width', width);
        rubberband.attr('height', height);
    }

    // Set the figure to an initial 600x600px, this will subsequently be updated
    // upon first draw.
    this._resize_canvas(600, 600);

    // Disable right mouse context menu.
    $(this.rubberband_canvas).bind("contextmenu",function(e){
        return false;
    });

    function set_focus () {
        canvas.focus();
        canvas_div.focus();
    }

    window.setTimeout(set_focus, 100);
}

mpl.figure.prototype._init_toolbar = function() {
    var fig = this;

    var nav_element = $('<div/>')
    nav_element.attr('style', 'width: 100%');
    this.root.append(nav_element);

    // Define a callback function for later on.
    function toolbar_event(event) {
        return fig.toolbar_button_onclick(event['data']);
    }
    function toolbar_mouse_event(event) {
        return fig.toolbar_button_onmouseover(event['data']);
    }

    for(var toolbar_ind in mpl.toolbar_items) {
        var name = mpl.toolbar_items[toolbar_ind][0];
        var tooltip = mpl.toolbar_items[toolbar_ind][1];
        var image = mpl.toolbar_items[toolbar_ind][2];
        var method_name = mpl.toolbar_items[toolbar_ind][3];

        if (!name) {
            // put a spacer in here.
            continue;
        }
        var button = $('<button/>');
        button.addClass('ui-button ui-widget ui-state-default ui-corner-all ' +
                        'ui-button-icon-only');
        button.attr('role', 'button');
        button.attr('aria-disabled', 'false');
        button.click(method_name, toolbar_event);
        button.mouseover(tooltip, toolbar_mouse_event);

        var icon_img = $('<span/>');
        icon_img.addClass('ui-button-icon-primary ui-icon');
        icon_img.addClass(image);
        icon_img.addClass('ui-corner-all');

        var tooltip_span = $('<span/>');
        tooltip_span.addClass('ui-button-text');
        tooltip_span.html(tooltip);

        button.append(icon_img);
        button.append(tooltip_span);

        nav_element.append(button);
    }

    var fmt_picker_span = $('<span/>');

    var fmt_picker = $('<select/>');
    fmt_picker.addClass('mpl-toolbar-option ui-widget ui-widget-content');
    fmt_picker_span.append(fmt_picker);
    nav_element.append(fmt_picker_span);
    this.format_dropdown = fmt_picker[0];

    for (var ind in mpl.extensions) {
        var fmt = mpl.extensions[ind];
        var option = $(
            '<option/>', {selected: fmt === mpl.default_extension}).html(fmt);
        fmt_picker.append(option)
    }

    // Add hover states to the ui-buttons
    $( ".ui-button" ).hover(
        function() { $(this).addClass("ui-state-hover");},
        function() { $(this).removeClass("ui-state-hover");}
    );

    var status_bar = $('<span class="mpl-message"/>');
    nav_element.append(status_bar);
    this.message = status_bar[0];
}

mpl.figure.prototype.request_resize = function(x_pixels, y_pixels) {
    // Request matplotlib to resize the figure. Matplotlib will then trigger a resize in the client,
    // which will in turn request a refresh of the image.
    this.send_message('resize', {'width': x_pixels, 'height': y_pixels});
}

mpl.figure.prototype.send_message = function(type, properties) {
    properties['type'] = type;
    properties['figure_id'] = this.id;
    this.ws.send(JSON.stringify(properties));
}

mpl.figure.prototype.send_draw_message = function() {
    if (!this.waiting) {
        this.waiting = true;
        this.ws.send(JSON.stringify({type: "draw", figure_id: this.id}));
    }
}


mpl.figure.prototype.handle_save = function(fig, msg) {
    var format_dropdown = fig.format_dropdown;
    var format = format_dropdown.options[format_dropdown.selectedIndex].value;
    fig.ondownload(fig, format);
}


mpl.figure.prototype.handle_resize = function(fig, msg) {
    var size = msg['size'];
    if (size[0] != fig.canvas.width || size[1] != fig.canvas.height) {
        fig._resize_canvas(size[0], size[1]);
        fig.send_message("refresh", {});
    };
}

mpl.figure.prototype.handle_rubberband = function(fig, msg) {
    var x0 = msg['x0'] / mpl.ratio;
    var y0 = (fig.canvas.height - msg['y0']) / mpl.ratio;
    var x1 = msg['x1'] / mpl.ratio;
    var y1 = (fig.canvas.height - msg['y1']) / mpl.ratio;
    x0 = Math.floor(x0) + 0.5;
    y0 = Math.floor(y0) + 0.5;
    x1 = Math.floor(x1) + 0.5;
    y1 = Math.floor(y1) + 0.5;
    var min_x = Math.min(x0, x1);
    var min_y = Math.min(y0, y1);
    var width = Math.abs(x1 - x0);
    var height = Math.abs(y1 - y0);

    fig.rubberband_context.clearRect(
        0, 0, fig.canvas.width, fig.canvas.height);

    fig.rubberband_context.strokeRect(min_x, min_y, width, height);
}

mpl.figure.prototype.handle_figure_label = function(fig, msg) {
    // Updates the figure title.
    fig.header.textContent = msg['label'];
}

mpl.figure.prototype.handle_cursor = function(fig, msg) {
    var cursor = msg['cursor'];
    switch(cursor)
    {
    case 0:
        cursor = 'pointer';
        break;
    case 1:
        cursor = 'default';
        break;
    case 2:
        cursor = 'crosshair';
        break;
    case 3:
        cursor = 'move';
        break;
    }
    fig.rubberband_canvas.style.cursor = cursor;
}

mpl.figure.prototype.handle_message = function(fig, msg) {
    fig.message.textContent = msg['message'];
}

mpl.figure.prototype.handle_draw = function(fig, msg) {
    // Request the server to send over a new figure.
    fig.send_draw_message();
}

mpl.figure.prototype.handle_image_mode = function(fig, msg) {
    fig.image_mode = msg['mode'];
}

mpl.figure.prototype.updated_canvas_event = function() {
    // Called whenever the canvas gets updated.
    this.send_message("ack", {});
}

// A function to construct a web socket function for onmessage handling.
// Called in the figure constructor.
mpl.figure.prototype._make_on_message_function = function(fig) {
    return function socket_on_message(evt) {
        if (evt.data instanceof Blob) {
            /* FIXME: We get "Resource interpreted as Image but
             * transferred with MIME type text/plain:" errors on
             * Chrome.  But how to set the MIME type?  It doesn't seem
             * to be part of the websocket stream */
            evt.data.type = "image/png";

            /* Free the memory for the previous frames */
            if (fig.imageObj.src) {
                (window.URL || window.webkitURL).revokeObjectURL(
                    fig.imageObj.src);
            }

            fig.imageObj.src = (window.URL || window.webkitURL).createObjectURL(
                evt.data);
            fig.updated_canvas_event();
            fig.waiting = false;
            return;
        }
        else if (typeof evt.data === 'string' && evt.data.slice(0, 21) == "data:image/png;base64") {
            fig.imageObj.src = evt.data;
            fig.updated_canvas_event();
            fig.waiting = false;
            return;
        }

        var msg = JSON.parse(evt.data);
        var msg_type = msg['type'];

        // Call the  "handle_{type}" callback, which takes
        // the figure and JSON message as its only arguments.
        try {
            var callback = fig["handle_" + msg_type];
        } catch (e) {
            console.log("No handler for the '" + msg_type + "' message type: ", msg);
            return;
        }

        if (callback) {
            try {
                // console.log("Handling '" + msg_type + "' message: ", msg);
                callback(fig, msg);
            } catch (e) {
                console.log("Exception inside the 'handler_" + msg_type + "' callback:", e, e.stack, msg);
            }
        }
    };
}

// from http://stackoverflow.com/questions/1114465/getting-mouse-location-in-canvas
mpl.findpos = function(e) {
    //this section is from http://www.quirksmode.org/js/events_properties.html
    var targ;
    if (!e)
        e = window.event;
    if (e.target)
        targ = e.target;
    else if (e.srcElement)
        targ = e.srcElement;
    if (targ.nodeType == 3) // defeat Safari bug
        targ = targ.parentNode;

    // jQuery normalizes the pageX and pageY
    // pageX,Y are the mouse positions relative to the document
    // offset() returns the position of the element relative to the document
    var x = e.pageX - $(targ).offset().left;
    var y = e.pageY - $(targ).offset().top;

    return {"x": x, "y": y};
};

/*
 * return a copy of an object with only non-object keys
 * we need this to avoid circular references
 * http://stackoverflow.com/a/24161582/3208463
 */
function simpleKeys (original) {
  return Object.keys(original).reduce(function (obj, key) {
    if (typeof original[key] !== 'object')
        obj[key] = original[key]
    return obj;
  }, {});
}

mpl.figure.prototype.mouse_event = function(event, name) {
    var canvas_pos = mpl.findpos(event)

    if (name === 'button_press')
    {
        this.canvas.focus();
        this.canvas_div.focus();
    }

    var x = canvas_pos.x * mpl.ratio;
    var y = canvas_pos.y * mpl.ratio;

    this.send_message(name, {x: x, y: y, button: event.button,
                             step: event.step,
                             guiEvent: simpleKeys(event)});

    /* This prevents the web browser from automatically changing to
     * the text insertion cursor when the button is pressed.  We want
     * to control all of the cursor setting manually through the
     * 'cursor' event from matplotlib */
    event.preventDefault();
    return false;
}

mpl.figure.prototype._key_event_extra = function(event, name) {
    // Handle any extra behaviour associated with a key event
}

mpl.figure.prototype.key_event = function(event, name) {

    // Prevent repeat events
    if (name == 'key_press')
    {
        if (event.which === this._key)
            return;
        else
            this._key = event.which;
    }
    if (name == 'key_release')
        this._key = null;

    var value = '';
    if (event.ctrlKey && event.which != 17)
        value += "ctrl+";
    if (event.altKey && event.which != 18)
        value += "alt+";
    if (event.shiftKey && event.which != 16)
        value += "shift+";

    value += 'k';
    value += event.which.toString();

    this._key_event_extra(event, name);

    this.send_message(name, {key: value,
                             guiEvent: simpleKeys(event)});
    return false;
}

mpl.figure.prototype.toolbar_button_onclick = function(name) {
    if (name == 'download') {
        this.handle_save(this, null);
    } else {
        this.send_message("toolbar_button", {name: name});
    }
};

mpl.figure.prototype.toolbar_button_onmouseover = function(tooltip) {
    this.message.textContent = tooltip;
};
mpl.toolbar_items = [["Home", "Reset original view", "fa fa-home icon-home", "home"], ["Back", "Back to  previous view", "fa fa-arrow-left icon-arrow-left", "back"], ["Forward", "Forward to next view", "fa fa-arrow-right icon-arrow-right", "forward"], ["", "", "", ""], ["Pan", "Pan axes with left mouse, zoom with right", "fa fa-arrows icon-move", "pan"], ["Zoom", "Zoom to rectangle", "fa fa-square-o icon-check-empty", "zoom"], ["", "", "", ""], ["Download", "Download plot", "fa fa-floppy-o icon-save", "download"]];

mpl.extensions = ["eps", "jpeg", "pdf", "png", "ps", "raw", "svg", "tif"];

mpl.default_extension = "png";var comm_websocket_adapter = function(comm) {
    // Create a "websocket"-like object which calls the given IPython comm
    // object with the appropriate methods. Currently this is a non binary
    // socket, so there is still some room for performance tuning.
    var ws = {};

    ws.close = function() {
        comm.close()
    };
    ws.send = function(m) {
        //console.log('sending', m);
        comm.send(m);
    };
    // Register the callback with on_msg.
    comm.on_msg(function(msg) {
        //console.log('receiving', msg['content']['data'], msg);
        // Pass the mpl event to the overridden (by mpl) onmessage function.
        ws.onmessage(msg['content']['data'])
    });
    return ws;
}

mpl.mpl_figure_comm = function(comm, msg) {
    // This is the function which gets called when the mpl process
    // starts-up an IPython Comm through the "matplotlib" channel.

    var id = msg.content.data.id;
    // Get hold of the div created by the display call when the Comm
    // socket was opened in Python.
    var element = $("#" + id);
    var ws_proxy = comm_websocket_adapter(comm)

    function ondownload(figure, format) {
        window.open(figure.imageObj.src);
    }

    var fig = new mpl.figure(id, ws_proxy,
                           ondownload,
                           element.get(0));

    // Call onopen now - mpl needs it, as it is assuming we've passed it a real
    // web socket which is closed, not our websocket->open comm proxy.
    ws_proxy.onopen();

    fig.parent_element = element.get(0);
    fig.cell_info = mpl.find_output_cell("<div id='" + id + "'></div>");
    if (!fig.cell_info) {
        console.error("Failed to find cell for figure", id, fig);
        return;
    }

    var output_index = fig.cell_info[2]
    var cell = fig.cell_info[0];

};

mpl.figure.prototype.handle_close = function(fig, msg) {
    var width = fig.canvas.width/mpl.ratio
    fig.root.unbind('remove')

    // Update the output cell to use the data from the current canvas.
    fig.push_to_output();
    var dataURL = fig.canvas.toDataURL();
    // Re-enable the keyboard manager in IPython - without this line, in FF,
    // the notebook keyboard shortcuts fail.
    IPython.keyboard_manager.enable()
    $(fig.parent_element).html('<img src="' + dataURL + '" width="' + width + '">');
    fig.close_ws(fig, msg);
}

mpl.figure.prototype.close_ws = function(fig, msg){
    fig.send_message('closing', msg);
    // fig.ws.close()
}

mpl.figure.prototype.push_to_output = function(remove_interactive) {
    // Turn the data on the canvas into data in the output cell.
    var width = this.canvas.width/mpl.ratio
    var dataURL = this.canvas.toDataURL();
    this.cell_info[1]['text/html'] = '<img src="' + dataURL + '" width="' + width + '">';
}

mpl.figure.prototype.updated_canvas_event = function() {
    // Tell IPython that the notebook contents must change.
    IPython.notebook.set_dirty(true);
    this.send_message("ack", {});
    var fig = this;
    // Wait a second, then push the new image to the DOM so
    // that it is saved nicely (might be nice to debounce this).
    setTimeout(function () { fig.push_to_output() }, 1000);
}

mpl.figure.prototype._init_toolbar = function() {
    var fig = this;

    var nav_element = $('<div/>')
    nav_element.attr('style', 'width: 100%');
    this.root.append(nav_element);

    // Define a callback function for later on.
    function toolbar_event(event) {
        return fig.toolbar_button_onclick(event['data']);
    }
    function toolbar_mouse_event(event) {
        return fig.toolbar_button_onmouseover(event['data']);
    }

    for(var toolbar_ind in mpl.toolbar_items){
        var name = mpl.toolbar_items[toolbar_ind][0];
        var tooltip = mpl.toolbar_items[toolbar_ind][1];
        var image = mpl.toolbar_items[toolbar_ind][2];
        var method_name = mpl.toolbar_items[toolbar_ind][3];

        if (!name) { continue; };

        var button = $('<button class="btn btn-default" href="#" title="' + name + '"><i class="fa ' + image + ' fa-lg"></i></button>');
        button.click(method_name, toolbar_event);
        button.mouseover(tooltip, toolbar_mouse_event);
        nav_element.append(button);
    }

    // Add the status bar.
    var status_bar = $('<span class="mpl-message" style="text-align:right; float: right;"/>');
    nav_element.append(status_bar);
    this.message = status_bar[0];

    // Add the close button to the window.
    var buttongrp = $('<div class="btn-group inline pull-right"></div>');
    var button = $('<button class="btn btn-mini btn-primary" href="#" title="Stop Interaction"><i class="fa fa-power-off icon-remove icon-large"></i></button>');
    button.click(function (evt) { fig.handle_close(fig, {}); } );
    button.mouseover('Stop Interaction', toolbar_mouse_event);
    buttongrp.append(button);
    var titlebar = this.root.find($('.ui-dialog-titlebar'));
    titlebar.prepend(buttongrp);
}

mpl.figure.prototype._root_extra_style = function(el){
    var fig = this
    el.on("remove", function(){
    fig.close_ws(fig, {});
    });
}

mpl.figure.prototype._canvas_extra_style = function(el){
    // this is important to make the div 'focusable
    el.attr('tabindex', 0)
    // reach out to IPython and tell the keyboard manager to turn it's self
    // off when our div gets focus

    // location in version 3
    if (IPython.notebook.keyboard_manager) {
        IPython.notebook.keyboard_manager.register_events(el);
    }
    else {
        // location in version 2
        IPython.keyboard_manager.register_events(el);
    }

}

mpl.figure.prototype._key_event_extra = function(event, name) {
    var manager = IPython.notebook.keyboard_manager;
    if (!manager)
        manager = IPython.keyboard_manager;

    // Check for shift+enter
    if (event.shiftKey && event.which == 13) {
        this.canvas_div.blur();
        event.shiftKey = false;
        // Send a "J" for go to next cell
        event.which = 74;
        event.keyCode = 74;
        manager.command_mode();
        manager.handle_keydown(event);
    }
}

mpl.figure.prototype.handle_save = function(fig, msg) {
    fig.ondownload(fig, null);
}


mpl.find_output_cell = function(html_output) {
    // Return the cell and output element which can be found *uniquely* in the notebook.
    // Note - this is a bit hacky, but it is done because the "notebook_saving.Notebook"
    // IPython event is triggered only after the cells have been serialised, which for
    // our purposes (turning an active figure into a static one), is too late.
    var cells = IPython.notebook.get_cells();
    var ncells = cells.length;
    for (var i=0; i<ncells; i++) {
        var cell = cells[i];
        if (cell.cell_type === 'code'){
            for (var j=0; j<cell.output_area.outputs.length; j++) {
                var data = cell.output_area.outputs[j];
                if (data.data) {
                    // IPython >= 3 moved mimebundle to data attribute of output
                    data = data.data;
                }
                if (data['text/html'] == html_output) {
                    return [cell, data, j];
                }
            }
        }
    }
}

// Register the function which deals with the matplotlib target/channel.
// The kernel may be null if the page has been refreshed.
if (IPython.notebook.kernel != null) {
    IPython.notebook.kernel.comm_manager.register_target('matplotlib', mpl.mpl_figure_comm);
}

</script>
</div>
<div class="cell-output cell-output-display">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAAGQCAYAAACAvzbMAAAgAElEQVR4Xu3deWzUxfvA8aegiIiAiXIXighRJIDhPoRWjZyJXOFQgaBiJIGAgMgvgkA0nP5BuQ+DYEi5KgFBQf7gCBFDICBgOKIBxJaC5gtUA7FA6S/P6K7bbku323a2M/ue5JtvsJ/PZ/Z5zew8neMDCXl5eXlCQQABBBBAoIQCCSSQEopxOQIIIICAESCB0BEQQAABBKISIIFExcZNCCCAAAIkEPoAAggggEBUAiSQqNi4CQEEEECABEIfQAABBBCISoAEEhUbNyGAAAIIkEDoAwgggAACUQmQQKJi4yYEEEAAARIIfQABBBBAICoBEkhUbNyEAAIIIEACoQ8ggAACCEQlQAKJio2bEEAAAQRIIPQBBBBAAIGoBEggUbFxEwIIIIAACYQ+gAACCCAQlQAJJCo2bkIAAQQQIIHQBxBAAAEEohIggUTFxk0IIIAAAiQQ+gACCCCAQFQCJJCo2LgJAQQQQIAEQh9AAAEEEIhKgAQSFRs3IYAAAgiQQOgDCCCAAAJRCZBAomLjJgQQQAABEgh9AAEEEEAgKgESSFRs3IQAAgggQAKhDyCAAAIIRCVAAomKjZsQQAABBEgg9AEEEEAAgagESCBRsXETAggggAAJhD6AAAIIIBCVAAkkKjZuQgABBBAggdAHEEAAAQSiEiCBRMXGTQgggAACJBD6AAIIIIBAVAIkkKjYuAkBBBBAgARCH0AAAQQQiEqABBIVGzchgAACCJBA6AMIIIAAAlEJkECiYuMmBBBAAAESCH0AAQQQQCAqARJIVGzchAACCCBAAqEPIIAAAghEJUACiYqNmxBAAAEESCD0AQQQQACBqAS8SCD379+XK1euyOOPPy4JCQlRQXATAgggUJEE8vLy5K+//pL69etLpUqVKtJHC34WLxJIRkaGJCYmVkhgPhQCCCBQGoHffvtNGjZsWJpHlNu9XiSQ7OxsqVWrlih0jRo1yg2LByOAAAK2BP7880/zi/HNmzelZs2atqotUT1eJBCFVmBNJCSQErU/FyOAQAUVcGFcI4FU0M7Dx0IAgfgWIIFYan8XoC1RUA0CCHgi4MK4xgzEk85GGAgg4JcACcRSe7oAbYmCahBAwBMBF8Y1ZiCedDbCQAABvwRIIJba0wVoSxRUgwACngi4MK4xA/GksxFGnAjk5oocOiSSlSVSr57Iiy+KVK4cJ8HHV5gkEEvt7QK0JQqq8Vlg2zaRCRNEMjL+i1LfUE5NFRk40OfI4zI2F8Y1ZiBx2TUJ2jkBTR6DB4vk5eX/6IG/+y09nSTiXKM++AOTQCw1qAvQliioxkcBXbZKSso/8wiNU5OIzkQuXmQ5y6P2d2FcYwbiUYcjFE8FDhwQSUkpPrj9+0WSk4u/jiucECCBWGomF6AtUVCNjwIbN4q8/nrxkaWliQwfXvx1XOGEgAvjGjMQJ7oSHzKuBZiBxGXzk0AsNbsL0JYoqMZHgcAeSGZm+Ca6xsseiI+tLi6Ma8xAvOx6BOWdQOAUlgYWehKLU1jeNXUgIBKIpaZ1AdoSBdX4LFDYeyD6L3EuWsQRXg/b3YVxjRmIhx2PkDwW4E10jxs3f2gkEEtN7QK0JQqqQQABTwRcGNeYgXjS2QgDAQT8EiCBWGpPF6AtUVANAgh4IuDCuMYMxJPORhgIIOCXAAnEUnu6AG2JgmoQQMATARfGNWYgnnQ2wkAAAb8ESCCW2tMFaEsUVIMAAp4IuDCuMQPxpLMRBgII+CVAArHUni5AW6KgGgQQ8ETAhXGNGYgnnY0wEEDALwESiKX2dAHaEgXVIICAJwIujGvMQDzpbISBAAJ+CTiZQJYtWyYLFy6Uq1evSuvWrWXJkiXSoUOHIltm69atMmPGDLl06ZI0a9ZM5s+fL3369Alen5eXJzNnzpQ1a9bIzZs3pWvXrrJixQpzbcGSk5MjHTt2lJMnT8qJEyekTZs2EfUIF6AjCoSLEEAAgX8FXBjX8s1ANm/eLCNHjpSVK1eagXzRokWiCeL8+fNSu3btsIY9fPiwdO/eXebOnSv9+vWTtLQ0k0COHz8uLVu2NNfrn/Xn69evlyZNmphkc/r0aTlz5oxUrVo13zMnTJggP//8s+zevZsEwtcIAQTiWsC5BKJJo3379rJ06VLTcPfv35fExEQZP368TJs2Lawxhw4dKrdu3ZJdu3YFf9apUyczc9AkpLOP+vXry+TJk2XKlCnmmuzsbKlTp46sW7dOhg0bFrxPk8akSZPkq6++kueff54EEtdfHYJHAAGnEsidO3ekWrVqkp6eLv379w+23qhRo8zS044dO8JatFGjRmbQnzhxYvBnuly1fft2swx14cIFadq0aVgy6NGjh0kyqamp5r5r165J27ZtzX1PPvmkmak8aAlLl7r0f4Gi0JroNDnVqFGDnocAAgg4L+BUArly5Yo0aNBAdFmqc+fOQfypU6fKwYMH5ciRI2ENUqVKFbM0NXz48ODPli9fLrNnzzZJQZ+lex767Hr16gWvGTJkiCQkJIgumeksRfdM9Lrp06ebvZTiEsisWbNMHQULCcT57wwBIIDAvwIkkAgSyOLFi2XLli0mSVWuXDmiBMIMhO8YAgj4LuBUAonVEpYul+3cudPMSAIlNzfXJJM33njDzHCKKy5AFxcDP0cAAQRCBVwY1/KdwtJNdD2yq0d3tegmuu5zjBs3rshN9Nu3b5sEEChdunSRVq1a5dtE1w103UjXoih6oiuwiX758mXz3wJFl7t69uxp9mL08zRs2LDYXuUCdLFBcAECCCAQIuDCuBZ2jFc3zVetWmUSiR7j1eWlc+fOmZNTesRX90n0WK4W3ePQDfF58+ZJ3759ZdOmTTJnzpywY7z689BjvKdOnSr0GK8+M5I9kIK9zAVovhkIIIBASQRcGNfC3kTXI7yBFwn1pJTuUehMQEtycrIkJSWZ2UOg6Hsigc1vfTlwwYIFhb5IuHr1anOaq1u3bqIb7c2bNy/UkgRSki7GtQgg4KuAkwnExcZwAdpFVz4zAgjETsCFcY2/Cyt2/YOaEUAAgSIFSCCWOocL0JYoqAYBBDwRcGFcYwbiSWcjDAQQ8EuABGKpPV2AtkRBNQgg4ImAC+MaMxBPOhthIICAXwIkEEvt6QK0JQqqQQABTwRcGNeYgXjS2QgDAQT8EiCBWGpPF6AtUVANAgh4IuDCuMYMxJPORhgIIOCXAAnEUnu6AG2JgmoQQMATARfGNWYgnnQ2wkAAAb8ESCCW2tMFaEsUVIMAAp4IuDCuMQPxpLMRBgII+CVAArHUni5AW6KgGgQQ8ETAhXGNGYgnnY0wEEDALwESiKX2dAHaEgXVIICAJwIujGvMQDzpbISBAAJ+CZBALLWnC9CWKKgGAQQ8EXBhXGMG4klnIwwEEPBLgARiqT2jgs7NFTl0SCQrS6RePZEXXxSpXNnSJ6YaBBBA4MECUY1rllHjcwaybZvIhAkiGRn/cTdsKJKaKjJwoOUmoDoEEEAgXIAEYqlXlAhak8fgwSJ5efk/XULCP39OTyeJWGo3qkEAgaIFSjSuxQgyvmYgumyVlJR/5hEKr0lEZyIXL7KcFaMOSbUIIPCPAAnEUk+IGPrAAZGUlOI/1f79IsnJxV/HFQgggEA5CUQ8rpVT/ZE8Nr5mIBs3irz+evEuaWkiw4cXfx1XIIAAAuUkQAIpJ9iCj40YmhmIpRahGgQQKK1AxONaaSsqxf3xNQMJ7IFkZoZvoisieyCl6ErcigACZSlAAilLzQc8q0TQgVNY+rzQk1icwrLUWlSDAAKRCJRoXIvkgeVwTXzNQAKAhb0HkpgosmgRR3jLoZPxSAQQKLkACaTkZlHdERU0b6JHZc1NCCBgRyCqcc3ORwvWEp8zEMvIVIcAAgiUVIAEUlKxKK93ATrK0LgNAQTiVMCFcY0ZSJx2TsJGAIGKLUACsdQ+LkBboqAaBBDwRMCFcY0ZiCedjTAQQMAvARKIpfZ0AdoSBdUggIAnAi6Ma8xAPOlshIEAAn4JkEAstacL0JYoqAYBBDwRcGFcYwbiSWcjDAQQ8EuABGKpPV2AtkRBNQgg4ImAC+MaMxBPOhthIICAXwIkEEvt6QK0JQqqQQABTwRcGNeYgXjS2QgDAQT8EiCBWGpPF6AtUVANAgh4IuDCuMYMxJPORhgIIOCXAAnEUnu6AG2JgmoQQMATARfGNWYgnnQ2wkAAAb8ESCCW2tMFaEsUVIMAAp4IuDCuhc1Ali1bJgsXLpSrV69K69atZcmSJdKhQ4cim2Tr1q0yY8YMuXTpkjRr1kzmz58vffr0CV6fl5cnM2fOlDVr1sjNmzela9eusmLFCnOtFr3vk08+kX379pk669evL2+++aZ89NFHUqVKlYi6ggvQEQXCRQgggMC/Ai6Ma/kSyObNm2XkyJGycuVK6dixoyxatEg0QZw/f15q164d1rCHDx+W7t27y9y5c6Vfv36SlpZmEsjx48elZcuW5nr9s/58/fr10qRJE5NsTp8+LWfOnJGqVavKnj17ROsdPny4PPPMM/LTTz/JmDFjZMSIEfLZZ59F1JlcgI4oEC5CAAEEXE0gmjTat28vS5cuNSHcv39fEhMTZfz48TJt2rSwhh06dKjcunVLdu3aFfxZp06dpE2bNiYJ6exDZxSTJ0+WKVOmmGuys7OlTp06sm7dOhk2bFihnUVnQDpLuXDhQkSdiQQSERMXIYCAQwIujGvBGcidO3ekWrVqkp6eLv379w8yjxo1yiw97dixI4y+UaNGMmnSJJk4cWLwZ7pctX37djl58qRJAE2bNpUTJ06YpBIoPXr0MH9OTU0ttDmnT59uZibHjh0r9Oc5OTmi/wsUhdZEp8mpRo0aDnURPioCCCBQuIBTCeTKlSvSoEED0WWpzp07ByOaOnWqHDx4UI4cORIWpe5R6NKULj8FyvLly2X27Nly7do18yzd89Bn16tXL3jNkCFDJCEhwSxdFSy//PKLtG3b1ixf6VJWYWXWrFmmjoKFBMJXEQEEfBEggZQwgWRmZorOTpKTk+Xzzz8vsh8wA/HlK0IcCCBQlIBTCSTWS1g6S9HEoXsouj9SqVKliHuWC9ARB8OFCCCAgIi4MK7lO4Wlm+h6ZFeP7mrRTXTd5xg3blyRm+i3b9+WnTt3Bhu8S5cu0qpVq3yb6LqBrhvpWhRFT3SFbqLrzCMlJcUsXW3YsEEqV65cog7kAnSJAuJiBBCIewEXxrWwY7y6ab5q1SqTSPQY75YtW+TcuXPm5JQe8dV9Ej2Wq0X3OHTJad68edK3b1/ZtGmTzJkzJ+wYr/489BjvqVOngsd4NXnozKNx48bmmtDkUbdu3Yg6kQvQEQXCRQgggMC/Ai6Ma2EvEuoR3sCLhHpSavHixeadEC060CclJZnZQ6DoeyJ6airwIuGCBQsKfZFw9erV5jRXt27dRDfamzdvbh6hzxo9enShnUaPAUdSXICOJA6uQQABBAICLoxr/F1Y9FcEEECgAgqQQCw1igvQliioBgEEPBFwYVxjBuJJZyMMBBDwS4AEYqk9XYC2REE1CCDgiYAL4xozEE86G2EggIBfAiQQS+3pArQlCqpBAAFPBFwY15iBeNLZCAMBBPwSIIFYak8XoC1RUA0CCHgi4MK4xgzEk85GGAgg4JcACcRSe7oAbYmCahBAwBMBF8Y1ZiCedDbCQAABvwRIIJba0wVoSxRUgwACngi4MK4xA/GksxEGAgj4JUACsdSeLkBboqAaBBDwRMCFcY0ZiCedjTAQQMAvARKIpfZ0AdoSBdUggIAnAi6Ma8xAPOlshIEAAn4JkEAstacL0JYoqAYBBDwRcGFcYwbiSWcjDAQQ8EuABGKpPV2AtkRBNQgg4ImAC+MaMxBPOhthIICAXwIkEEvt6QK0JQqqQQABTwRcGNeYgXjS2QgDAQT8EiCBWGpPF6AtUVANAgh4IuDCuMYMxJPORhgIIOCXAAnEUnu6AG2JgmoQQMATARfGNWYgnnQ2wkAAAb8ESCCW2tMFaEsUVIMAAp4IuDCuMQPxpLMRBgII+CVAArHUni5AW6KgGgQQ8ETAhXGNGYgnnY0wEEDALwESiKX2dAHaEgXVIICAJwIujGvMQDzpbISBAAJ+CZBALLWnC9CWKKgGAQQ8EXBhXGMG4klnIwwEEPBLgARiqT1dgLZEQTUIIOCJgAvjGjMQTzobYSCAgF8CJBBL7ekCtCUKqkEAAU8EXBjXmIF40tkIAwEE/BIggVhqTxegLVFQDQIIeCLgwrjGDMSTzkYYCCDglwAJxFJ7ugBtiYJqEEDAEwEXxjVmIJ50NsJAAAG/BEggltrTBWhLFFSDAAKeCLgwrjED8aSzEQYCCPglQAKx1J4uQFuioBoEEPBEwIVxjRmIJ52NMBBAwC8BEoil9nQB2hIF1SCAgCcCLoxrzEA86WyEEaFAbq7IoUMiWVki9eqJvPiiSOXKEd7MZQiUUKAU/c3JBLJs2TJZuHChXL16VVq3bi1LliyRDh06FKm2detWmTFjhly6dEmaNWsm8+fPlz59+gSvz8vLk5kzZ8qaNWvk5s2b0rVrV1mxYoW5NlCuX78u48ePl507d0qlSpVk0KBBkpqaKtWrV4+otVyAjigQLipfgW3bRCZMEMnI+K+ehg1FUlNFBg4s37p5evwJlLK/uTCu5ZuBbN68WUaOHCkrV66Ujh07yqJFi0QTxPnz56V27dphHeDw4cPSvXt3mTt3rvTr10/S0tJMAjl+/Li0bNnSXK9/1p+vX79emjRpYpLN6dOn5cyZM1K1alVzTe/evSUrK0tWrVold+/eldGjR0v79u3N8yIpLkBHEgfXlKOAfpkHDxbJy8tfSULCP39OTyeJlCN/3D26DPqbC+NavgSiSUMH7qVLl5r2vn//viQmJprZwbRp08L6wNChQ+XWrVuya9eu4M86deokbdq0MUlIZx/169eXyZMny5QpU8w12dnZUqdOHVm3bp0MGzZMzp49Ky1atJCjR49Ku3btzDV79uwxs5iMjAxzf3HFBejiYuDn5SigywhJSflnHqHVaRLRmcjFiyxnlWMzxM2jy6i/uTCuBRPInTt3pFq1apKeni79+/cPtvWoUaPM0tOOHTvC2r9Ro0YyadIkmThxYvBnuly1fft2OXnypFy4cEGaNm0qJ06cMEklUHr06GH+rMtUa9euNQnmxo0bwZ/fu3fPzE509jNgwICwenNyckT/FygKrYlOk1ONGjXipp8SaIQCBw6IpKQUf/H+/SLJycVfxxUIPEigjPqbUwnkypUr0qBBA9Flqc6dOwd5pk6dKgcPHpQjR46EkVWpUsUsTQ0fPjz4s+XLl8vs2bPl2rVr5lm656HPrqcblv+WIUOGSEJCguiS2Zw5c8wzdJkstOiSmT5n7NixYfXOmjXL/KxgIYHwvS5UYONGkddfLx5Hl0xD+nLxN3AFAoUIlFF/I4GUUwJhBsLXtkQCZfQbYYnq5OL4FSij/uZUAnFpCatgz3QBOn6/TRUg8sCadGZm+Ca6fjz2QCpAI3n0Ecqov7kwroVtouuRXT26q0U30XWfY9y4cUVuot++fdscvw2ULl26SKtWrfJtousGuu5zaFEUXZ4quIl+7Ngxadu2rblm79690qtXLzbRPfpOxTyUwKkY/SChJ7E4hRXzpvHyA5RBf3MugeiehG6a63FaTSR6jHfLli1y7tw5c3JKj/jqPokey9Wiexy6IT5v3jzp27evbNq0yexpFDzGqz8PPcZ76tSpsGO8umeiJ7cCx3j1RBbHeL38asUuqMLO5ScmiixaxBHe2LWKvzWXsr85l0C0JfUIb+BFQj0ptXjxYvNOiJbk5GRJSkoys4dA0ZNS06dPD75IuGDBgkJfJFy9erU5zdWtWzfRjfbmzZsHn6EvEuosJ/RFQq2XFwn9/W7FLLJSvBkcs89Mxe4KlKK/OZlAXGwpF6BddOUzI4BA7ARcGNf4u7Bi1z+oGQEEEChSgARiqXO4AG2JgmoQQMATARfGNWYgnnQ2wkAAAb8ESCCW2tMFaEsUVIMAAp4IuDCuMQPxpLMRBgII+CVAArHUni5AW6KgGgQQ8ETAhXGNGYgnnY0wEEDALwESiKX2dAHaEgXVIICAJwIujGvMQDzpbISBAAJ+CZBALLWnC9CWKKgGAQQ8EXBhXGMG4klnIwwEEPBLgARiqT1dgLZEQTUIIOCJgAvjGjMQTzobYSCAgF8CJBBL7ekCtCUKqkEAAU8EXBjXmIF40tkIAwEE/BIggVhqTxegLVFQDQIIeCLgwrjGDMSTzkYYCCDglwAJxFJ7ugBtiYJqEEDAEwEXxjVmIJ50NsJAAAG/BEggltrTBWhLFFSDAAKeCLgwrjED8aSzEQYCCPglQAKx1J4uQFuioBoEEPBEwIVxjRmIJ52NMBBAwC8BEoil9nQB2hIF1SCAgCcCLoxrzEA86WyEgQACfgmQQCy1pwvQliioBgEEPBFwYVxjBuJJZyMMBBDwS4AEYqk9XYC2REE1CCDgiYAL4xozEE86G2EggIBfAiQQS+3pArQlCqpBAAFPBFwY15iBeNLZCAMBBPwSIIFYak8XoC1RUA0CCHgi4MK4xgzEk85GGAgg4JcACcRSe7oAbYmCahBAwBMBF8Y1ZiCedDbCQAABvwRIIJba0wVoSxRUgwACngi4MK4xA/GksxEGAgj4JUACsdSeLkBboqAaBBDwRMCFcY0ZiCedjTAQQMAvARKIpfZ0AdoSBdUggIAnAi6Ma8xAPOlshIEAAn4JkEAstacL0JYoqAYBBDwRcGFcYwbiSWcjDAQQ8EuABGKpPV2AtkRBNQgg4ImAC+MaMxBPOhthIICAXwIkEEvt6QK0JQqqQQABTwRcGNeYgXjS2QgDAQT8EnAqgVy/fl3Gjx8vO3fulEqVKsmgQYMkNTVVqlevXmSr/P333zJ58mTZtGmT5OTkSM+ePWX58uVSp06d4D2XL1+WsWPHyv79+82zRo0aJXPnzpWHHnrIXLNt2zZZsWKF/Pjjj+YZzz//vMyaNcs8K9LiAnSksXAdAgggoAIujGvBGUjv3r0lKytLVq1aJXfv3pXRo0dL+/btJS0trcjW1MTwzTffyLp166RmzZoybtw4k3y+//57c09ubq60adNG6tatKwsXLjTPHzlypIwZM0bmzJljrpk4caLUr19fUlJSpFatWvLFF1/IZ599JkeOHJEXXnghop7kAnREgXARAggg8K+AC+OaSSBnz56VFi1ayNGjR6Vdu3bm4+/Zs0f69OkjGRkZZoAvWLKzs+Wpp54yCWbw4MHmx+fOnZPnnntOfvjhB+nUqZPs3r1b+vXrJ1euXAnOSlauXCkffvih/PHHH1KlSpVCO4vOQoYOHSoff/xxRJ3JBeiIAuEiBBBAwLUEsnbtWrMUdePGjWDj3bt3T6pWrSpbt26VAQMGhDXqvn375OWXXzb36MwhUBo3bmxmFe+//75JAF9//bVZngqUixcvytNPPy3Hjx8vdIZx//59SUpKkqlTp5oZTSSFBBKJEtcggIBLAi6Ma2YGostJ69evl/Pnz+fzrV27tsyePdvsYRQsOvPQZS7dtwgtHTp0MMtR8+fPl3fffVd+/fVX+e6774KX3L59Wx577DH59ttvRZfNCpYFCxbIvHnzzGxG6y+saJ2h9Sp0YmKi6KyoRo0aLvURPisCCCBQqIATCeTs2bN5upFdERKIJiXdH9mxY4e88sorRXYr3WTXxFawkED4JiKAgC8CTiSQnJycvA0bNsR8CUtPcr311ltmyaxv374P7APMQHz5ihAHAggUJeBEAgndRD927Ji0bdvWxLN3717p1atXsZvoGzduNEd+tegS2LPPPhu2ia6nrwLLUatXr5YPPvhAfv/9d3nkkUfMffoMTR6aRF577bUS9ygXoEscFDcggEBcC7gwruU7xnvt2jXRU1KBY7x6IitwjDczM9Nsmn/55Zei+xxadG9E9zL0GK/uPeh7JFoOHz5s/j9wjFdPcenextWrV2XEiBHyzjvvBI/x6vP13RB952TgwIHBDvPoo4+ao8GRFBegI4mDaxBAAIGAgAvjWjCB6IuEeuop9EXCxYsXB18kvHTpkjRp0sS8EJicnGxiDLxIqDOI0BcJ9b2PQNFNdE00Bw4cMJvnmix0kzzwIqE+6+DBg2G9Rq/TxBRJcQE6kji4BgEEEHAygbjcbCQQl1uPz44AAoUJuDCu8Xdh0XcRQACBCihAArHUKC5AW6KgGgQQ8ETAhXGNGYgnnY0wEEDALwESiKX2dAHaEgXVIICAJwIujGvMQDzpbISBAAJ+CZBALLWnC9CWKKgGAQQ8EXBhXGMG4klnIwwEEPBLgARiqT1dgLZEQTUIIOCJgAvjGjMQTzobYSCAgF8CJBBL7ekCtCUKqkEAAU8EXBjXmIF40tkIAwEE/BIggVhqTxegLVFQDQIIeCLgwrjGDMSTzkYYCCDglwAJxFJ7ugBtiYJqEEDAEwEXxjVmIJ50NsJAAAG/BEggltrTBWhLFFSDAAKeCLgwrjED8aSzEQYCCPglQAKx1J5RQefmihw6JJKVJVKvnsiLL4pUrmzpE1MNAggg8GCBqMY1y6jxOQPZtk1kwgSRjIz/uBs2FElNFRk40HITUB0CCCAQLkACsdQrSgStyWPwYJG8vPyfLiHhnz+np5NELLUb1SCAQNECJRrXYgQZXzMQXbZKSso/8wiF1ySiM5GLF1nOilGHpFoEEPhHgARiqSdEDH3ggEhKSvGfav9+keTk4q/jCgQQQKCcBCIe18qp/kgeG18zkI0bRV5/vXiXtDSR4cOLv44rEEAAgXISIIGUE2zBx0YMzQzEUotQDQIIlFYg4nGttBWV4v74moEE9kAyM8M30RWRPZBSdCVuRQCBshQggZSl5gOeVSLowCksfV7oSSxOYVlqLapBAIFIBPAb3XIAABGGSURBVEo0rkXywHK4Jr5mIAHAwt4DSUwUWbSII7zl0Ml4JAIIlFyABFJys6juiAqaN9GjsuYmBBCwIxDVuGbnowVric8ZiGVkqkMAAQRKKkACKalYlNe7AB1laNyGAAJxKuDCuMYMJE47J2EjgEDFFiCBWGofF6AtUVANAgh4IuDCuMYMxJPORhgIIOCXAAnEUnu6AG2JgmoQQMATARfGNWYgnnQ2wkAAAb8ESCCW2tMFaEsUVIMAAp4IuDCuMQPxpLMRBgII+CVAArHUni5AW6KgGgQQ8ETAhXGNGYgnnY0wEEDALwESiKX2dAHaEgXVIICAJwIujGvMQDzpbISBAAJ+CZBALLWnC9CWKKgGAQQ8EXBhXGMG4klnIwwEEPBLgARiqT1dgLZEQTUIIOCJgAvjGjMQTzobYSCAgF8CJBBL7ekCtCUKqkEAAU8EXBjXmIF40tkIAwEE/BIggVhqTxegLVFQDQIIeCLgwrgWnIFcv35dxo8fLzt37pRKlSrJoEGDJDU1VapXr15kc/z9998yefJk2bRpk+Tk5EjPnj1l+fLlUqdOneA9ly9flrFjx8r+/fvNs0aNGiVz586Vhx56KOy533//vfTo0UNatmwpP/74Y8TdwAXoiIPhQgQQQEBEXBjXggmkd+/ekpWVJatWrZK7d+/K6NGjpX379pKWllZkY2pi+Oabb2TdunVSs2ZNGTdunEk+mgi05ObmSps2baRu3bqycOFC8/yRI0fKmDFjZM6cOfmee/PmTWnbtq0888wzcu3aNRIIXyEEEIhrAWcSyNmzZ6VFixZy9OhRadeunWm0PXv2SJ8+fSQjI0Pq168f1pDZ2dny1FNPmQQzePBg8/Nz587Jc889Jz/88IN06tRJdu/eLf369ZMrV64EZyUrV66UDz/8UP744w+pUqVK8LnDhg2TZs2aSeXKlWX79u0kkLj+6hA8Agg4k0DWrl1rlqJu3LgRbLV79+5J1apVZevWrTJgwICw1ty3b5+8/PLL5p5atWoFf964cWOZOHGivP/++/Lxxx/L119/nS8ZXLx4UZ5++mk5fvy4vPDCC+a+L774QlasWCGHDx+WTz/9lATCdwcBBOJewJkEostJ69evl/Pnz+drtNq1a8vs2bPNHkbBojMPXebSvY/Q0qFDB0lJSZH58+fLu+++K7/++qt89913wUtu374tjz32mHz77beiy2Y///yzdOvWTQ4dOiTNmzeXWbNmFZtAtM7QehU6MTFRdFZUo0aNuO94ACCAgPsCTiSQs2fP5m3bti0mCeTVV181S11vv/22vPfee6bFI0kgeo0mtoKFBOL+l4YIEEDgHwEnEkhOTk7ehg0bYrKE1aRJE3niiSfMvkeg3L9/X/Ly8sx/27t3r7z00kth/YkZCF8xBBDwXcCJBJKXl5cX2EQ/duyYOQmlRQfvXr16FbuJvnHjRnPkV4sugT377LNhm+h6+kqXw7SsXr1aPvjgA/n999/l4YcfljNnzuTrB3oMWPdX0tPTRROMLncVV1yALi4Gfo4AAgiECrgwruU7xqvHZ/WUVOAYr57IChzjzczMNJvmX375peg+hxbdG9G9DD3Gq3sP+h6JFt0M1xI4xqunuBYsWCBXr16VESNGyDvvvBN2jDcAF8kSVsFu5gI0Xw0EEECgJAIujGv5XiTU9zhCXyRcvHhx8EXCS5cumRmBvhCYnJxsHAIvEuosJPRFQn3vI1B0E10TzYEDB8xsQl8knDdvXqEvEuo9JJCSdDGuRQABXwWcSiAuN4IL0C778tkRQMC+gAvjGn+Zov1+QY0IIIBAsQIkkGKJyuYCF6DLJlKeggAC8SLgwrjGDCReeiNxIoCAUwIkEEvN5QK0JQqqQQABTwRcGNeYgXjS2QgDAQT8EiCBWGpPF6AtUVANAgh4IuDCuMYMxJPORhgIIOCXAAnEUnu6AG2JgmoQQMATARfGNWYgnnQ2wkAAAb8ESCCW2tMFaEsUVIMAAp4IuDCuMQPxpLMRBgII+CVAArHUni5AW6KgGt8FcnNFDh0SycoSqVdP5MUXRUL+PR3fw4+n+FwY15iBxFOPJFa3BbZtE5kwQSQj4784GjYUSU0VGTjQ7dj49GECJBBLncIFaEsUVOOrgCaPwYNF8vLyR5iQ8M+f09NJIp61vQvjGjMQzzod4XgooMtWSUn5Zx6hYWoS0ZnIxYssZ3nU/CQQS43pArQlCqrxUeDAAZGUlOIj279f5N9/7K34i7miogu4MK4xA6novYjPh8DGjSKvv168Q1qayPDhxV/HFU4IkEAsNZML0JYoqMZHAWYgPrZqsTG5MK4xAym2GbkAgRgLBPZAMjPDN9H1o7EHEuMGKp/qSSDl4xr2VBegLVFQja8CgVNYGl/oSSxOYfna4uLCuMYMxNvuR2DeCRT2HkhiosiiRRzh9a6xhQRiq01dyNS2LKjHcwHeRPe8gf8Lz4VxjRlI3HRHAkUAAZcESCCWWssFaEsUVIMAAp4IuDCuMQPxpLMRBgII+CVAArHUni5AW6KgGgQQ8ETAhXGNGYgnnY0wEEDALwESiKX2dAHaEgXVIICAJwIujGvMQDzpbISBAAJ+CZBALLVndna21KpVS3777TepUaOGpVqpBgEEECg/AU0giYmJcvPmTalZs2b5VVSKJ3sxA8nIyDDQFAQQQMA3Af3FuKH+ey8VsHiRQO7fvy9XrlyRxx9/XBICfzdQhNiBLB+Ps5d4jZ2442+m7mKb5+XlyV9//SX169eXSpUqRTii2b3MiwRSGjIX1hlLE9+D7o3X2Ik7O+6WeuO1zctr7Ag8lwTy559mfVH3UeJt/yRev1TETV8v74E1Xp5PAiGBxF3yJIGQQOJlgC/vOOM+geTk5MjcuXPl//7v/+SRRx4pb+8K9fx4jZ246esV6ovo8IeJ+wTicNvx0RFAAIGYCpBAYspP5QgggIC7AiQQd9uOT44AAgjEVIAEElN+KkcAAQTcFSCBuNt2fHIEEEAgpgLeJZDr16/L+PHjZefOnebtzUGDBklqaqpUr169SOi///5bJk+eLJs2bRI9odOzZ09Zvny51KlTJ3jP5cuXZezYsbJ//37zrFGjRpnTWw899FDYc7///nvp0aOHtGzZUn788UdrDRyr2Ldt2yYrVqwwsarf888/L7NmzTKO5VGWLVsmCxculKtXr0rr1q1lyZIl0qFDhyKr2rp1q8yYMUMuXbokzZo1k/nz50ufPn2C1+sbvzNnzpQ1a9aYv3eoa9euJh69NlCisfUhdjX75JNPZN++fcZb34p+88035aOPPpIqVaqUR4iFPjMWbR74INqnO3bsKCdPnpQTJ05ImzZtrMVd0SvyLoH07t1bsrKyZNWqVXL37l0ZPXq0tG/fXtLS0opsC00M33zzjaxbt868VDhu3DiTfDQRaMnNzTWdpm7dumbg0uePHDlSxowZI3PmzMn3XB2A2rZtK88884xcu3bNagKJVewTJ040A0tKSor5Sy2/+OIL+eyzz+TIkSPywgsvlOl3YPPmzcZ+5cqV5ku9aNEi0QRx/vx5qV27dlhdhw8flu7du5tk369fP9MPNIEcP37cJHgt+mf9+fr166VJkyYm2Zw+fVrOnDkjVatWNddEY1umgYtILGLfs2ePqXf48OGmT//000+m348YMcK0sY0Si7hD45owYYL8/PPPsnv3bhJIgQb3KoGcPXtWWrRoIUePHpV27dqZUPULoL9t6l+4qINcwaJvoD/11FNmYBk8eLD58blz5+S5556TH374QTp16mQ6jg4++vdtBWYlOoB9+OGH8scff+T7TWzYsGHmN9fKlSvL9u3brSWQihB7qK3OQoYOHSoff/xxmY4xmjT0F4KlS5ea5+rfg6Z/kabOOqdNmxZWl36GW7duya5du4I/0zbVXwi0DXX2of1CZ6BTpkwx12if0HbWXyi0PaOxLdOg/31YLGIvLA79JUpnaBcuXCiPMMOeGcu49bs/adIk+eqrr8zMmhlI/ubxKoGsXbvWDAQ3btwIRnnv3j3zW6T+ljpgwICwzqlT85dfftnco789B0rjxo1Ff7N+//33zSD49ddf50sGFy9elKefftr8Jhv4LVt/89Yvlv7W++mnn1pNILGOPRRWB/WkpCSZOnWqmc2VVblz545Uq1ZN0tPTpX///sHH6nKizvx27NgRVlWjRo3MAKBtGSi6XKXJXZckdBBs2rRp2MCgS5CaZHT5Mxrbsoo58JxYxV5YHNOnTze/mB07dqyswwx7Xizj1hUEXU3QvvLkk0+a2SkJxOMEostJugyhyxmhRZc2Zs+ebfYwChadeegyl65zhhZdU9clGV3eePfdd+XXX3+V7777LnjJ7du35bHHHpNvv/3WLG/oFLdbt25y6NAhad68udkDsDkDiWXsBU0XLFgg8+bNMzO5wpaVoh11dAbYoEEDk6A7d+4cfIwmqoMHD5ols4JF1+m1T+gSTKDo/pb2Bx0g9Fm656HPrlevXvCaIUOGmL/ZWZdPorGNNsai7otV7AU/zy+//GIGVV2+0qWs8i6xiltnprpyoX1DE6buBZFAwlvbiRmILk3oQP6gossMupkbiwTy6quvmqWut99+W9577z3zMcsqgVT02DV5hhZNyDqw6GzglVdeKdPxJVaDCQnkn2bMzMw0h0OSk5Pl888/L9O2rWiJc/HixbJlyxbzi4kuR5NACm8hJxKI7jP873//e2CH1eWkDRs2xGQJS38zeeKJJ0xHCxRdxtHfYvS/7d27V1566aWovnAVPfbQTXI9xfbWW2+Z5cK+fftGFe+DborVcgZLWGJmaJo49Bcl3Ruy9e9TxKrNdYlUT3KG/vtCephGv89vvPGG+UWVIuJEAom0oQKbnbo2q9NsLTp49+rVq9hN9I0bN5ojv1p0CezZZ58N20TX01eBJZnVq1fLBx98IL///rs8/PDD5sROaNFlEt1f0fV6TTC63FWeJVaxB/4CSvXT5KFJ5LXXXiu3UHVDVZcX9eiuFk3Uus+hey1FbaLrcqMOBoHSpUsXadWqVb5NdN1A1/0zLfq39Wo7F9xEL0m/Kg+AWMQemHnocq5+p/SXtNBflMojzoLPjEXcemxf+0GgaALVY+n6fdbPU1H/hUAb7RFah1cJRAPTJRVd29YTNoFjvHoiK3CMV6fhumn+5ZdfBt8d0L0R3cvQAUP/TRA90aNF18e1BI7x6mkdXd/X8/B6jPGdd94JO8YbwC2rJaySdIhYxa62upGtG84DBw4MfuRHH320zP8tZ92T0Lr0mLYmEj3Gq0sNut+iJ6f0iK/uk+ix3EAb6rKL7snorEgTnC5JFTzGqz8PPcZ76tSpsGO8D+pXJWmnaK+NRez6fdGZhx4qUZ/Q5KHH2m2UWMRdMC6WsApvae8SiL7wpb+Nhr5IqOuZgRcJAx1BXwjUL4aWwIuE+lt06IuEoV8Q3UTXRHPgwAEzm9BBTAedwl4k1GfGIoHEKnZ11LXigkWNNCmXddEjvIEXCfWklLav/laoRT+LngALrVeX1AIboXrEWn8JKOxFQp1V6mkuPQyhM0g9DBEoxdmWdYxFPc927Oqoh0wKK7pEa6vYjpsEElnLepdAIgubqxBAAAEESitAAimtIPcjgAACcSpAAonThidsBBBAoLQCJJDSCnI/AgggEKcCJJA4bXjCRgABBEorQAIprSD3I4AAAnEqQAKJ04YnbAQQQKC0AiSQ0gpyPwIIIBCnAiSQOG14wkYAAQRKK0ACKa0g9yOAAAJxKkACidOGJ2wEEECgtAIkkNIKcj8CCCAQpwIkkDhteMJGAAEESitAAimtIPcjgAACcSpAAonThidsBBBAoLQCJJDSCnI/AgggEKcCJJA4bXjCRgABBEorQAIprSD3I4AAAnEqQAKJ04YnbAQQQKC0AiSQ0gpyPwIIIBCnAiSQOG14wkYAAQRKK0ACKa0g9yOAAAJxKkACidOGJ2wEEECgtAL/D71kJZqz+cH8AAAAAElFTkSuQmCC" width="400">
</div>
<div class="cell-output cell-output-stdout">
<pre><code>cond(A)=1.53613e+10
[[-160003.33190407]
 [  32000.66623836]
 [  32000.66642717]
 [  32000.66642717]
 [  32000.66623836]
 [  32000.66654386]]</code></pre>
</div>
</div>
<div id="cell-21" class="cell" data-execution_count="16">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>nodes3D <span class="op">=</span> np.zeros((num<span class="op">+</span><span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>nodes3D[:,:<span class="dv">2</span>] <span class="op">=</span> nodes</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>nodes3D[:,<span class="dv">2</span>] <span class="op">=</span> np.sqrt(<span class="dv">1</span> <span class="op">-</span> nodes3D[:,<span class="dv">0</span>]<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> nodes3D[:,<span class="dv">1</span>]<span class="op">**</span><span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-22" class="cell" data-execution_count="17">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> foo2d(x,y):</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">**</span><span class="dv">3</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">3</span> <span class="op">+</span> (x<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(y<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> L2d(x,y):</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">6</span><span class="op">*</span>(x<span class="op">+</span>y)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>D2_approx <span class="op">=</span> np.<span class="bu">sum</span>( [ w<span class="op">*</span>foo2d(<span class="op">*</span>n) <span class="cf">for</span> n,w <span class="kw">in</span> <span class="bu">zip</span>(nodes, ws)])</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(D2_approx, L2d(<span class="op">*</span>nodes[<span class="dv">0</span>]))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>2.80942640529247e-05 0.0</code></pre>
</div>
</div>
<div id="cell-23" class="cell" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> foo_surf(x,y,z):</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> y<span class="op">**</span><span class="dv">2</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> L_surf(x,y,z):</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> foo_surf(x,y,z)<span class="op">*</span><span class="dv">2</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>surf_approx <span class="op">=</span> np.<span class="bu">sum</span>( [ w<span class="op">*</span>foo_surf(<span class="op">*</span>n) <span class="cf">for</span> n,w <span class="kw">in</span> <span class="bu">zip</span>(nodes3D, ws)])</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(surf_approx, L_surf(<span class="op">*</span>nodes3D[<span class="dv">0</span>]))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>3.053246708947799e-06 0.0</code></pre>
</div>
</div>
<div id="cell-24" class="cell" data-execution_count="19">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>ws</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>array([[-102375.66334239],
       [  21855.31749951],
       [ -12576.89209538],
       [  24010.14037856],
       [   1968.7261452 ],
       [  16451.93353099],
       [   3207.46368975],
       [  23920.65017625],
       [ -15509.77494064],
       [  24787.8668288 ],
       [   7180.38872595],
       [   7079.84335921]])</code></pre>
</div>
</div>
</section>
<section id="tangent-plane-scaled" class="level1">
<h1>Tangent Plane Scaled</h1>
<div id="cell-26" class="cell" data-execution_count="173">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose RBF</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>rbf <span class="op">=</span> rbf_obj[<span class="st">'rbf'</span>]</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>zeta  <span class="op">=</span> rbf_obj[<span class="st">'zeta'</span>]</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>d2rbf <span class="op">=</span> rbf_obj[<span class="st">'d2rbf'</span>]</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the 2D laplacian</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>Lrbf <span class="op">=</span> <span class="kw">lambda</span> r,eps: zeta(r,eps) <span class="op">+</span> d2rbf(r,eps)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose solution and forcing fuction</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>sol_deg <span class="op">=</span> sphere_harm_degs[solution_index]</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>exact <span class="op">=</span> <span class="kw">lambda</span> x: sphere_harm[solution_index](<span class="op">*</span>x)<span class="op">*-</span>sol_deg<span class="op">*</span>(sol_deg<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>forcing <span class="op">=</span> <span class="kw">lambda</span> x: sphere_harm[solution_index](<span class="op">*</span>x)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Harmonic degree: </span><span class="sc">%d</span><span class="st">'</span> <span class="op">%</span> sol_deg)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dist(nodes1, nodes2):</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> nodes1.ndim <span class="kw">is</span> <span class="dv">1</span>:</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>        nodes1 <span class="op">=</span> nodes1.reshape((<span class="dv">1</span>,<span class="bu">len</span>(nodes1)))</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> nodes2.ndim <span class="kw">is</span> <span class="dv">1</span>:</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>        nodes2 <span class="op">=</span> nodes2.reshape((<span class="dv">1</span>,<span class="bu">len</span>(nodes2)))</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>    d <span class="op">=</span> <span class="bu">len</span>(nodes1[<span class="dv">0</span>]) <span class="co"># the dimension of each vector</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>    n1 <span class="op">=</span> <span class="bu">len</span>(nodes1)</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>    n2 <span class="op">=</span> <span class="bu">len</span>(nodes2)</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create a row vector of d dimensional vectors</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>    row <span class="op">=</span> nodes1.reshape((<span class="dv">1</span>,n1,d)) </span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create a column vector of d dimensional vectors</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>    col <span class="op">=</span> nodes2.reshape((n2,<span class="dv">1</span>,d)) </span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>    ret <span class="op">=</span> (row<span class="op">-</span>col)<span class="op">**</span><span class="dv">2</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>    ret <span class="op">=</span> np.<span class="bu">sum</span>(ret,<span class="dv">2</span>) <span class="co">#sum each d-dimensional vector</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.sqrt(ret)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Harmonic degree: 3</code></pre>
</div>
</div>
<div id="cell-27" class="cell" data-execution_count="174">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">2000</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>my_node <span class="op">=</span> n<span class="op">//</span><span class="dv">7</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>rbf_obj <span class="op">=</span> rbf_dict[<span class="st">'multiquadric'</span>]</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>eps <span class="op">=</span> <span class="fl">.5</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>solution_index <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>show_plot <span class="op">=</span> <span class="va">False</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co">################################################################################</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co">#generate Nodes</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>nodes <span class="op">=</span> gen_spiral_nodes(n)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>tree <span class="op">=</span> cKDTree(np.array(nodes))</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>stencil <span class="op">=</span> tree.query(nodes[my_node], k)[<span class="dv">1</span>]</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>nn <span class="op">=</span> np.array([nodes[i] <span class="cf">for</span> i <span class="kw">in</span> stencil]) <span class="co">#nodes in the stencil</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>node <span class="op">=</span> nn[<span class="dv">0</span>]</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct rotation matrix</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>t1, t2 <span class="op">=</span> np.eye(<span class="dv">3</span>)[:<span class="dv">2</span>] <span class="co"># tangent vectors</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>t1 <span class="op">-=</span> np.dot(node, t1)<span class="op">*</span>node</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>t1 <span class="op">/=</span> la.norm(t1)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>t2 <span class="op">-=</span> np.dot(node, t2)<span class="op">*</span>node <span class="op">+</span> np.dot(t1, t2)<span class="op">*</span>t1</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>t2 <span class="op">/=</span> la.norm(t2)</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>RT <span class="op">=</span> np.array([t1, t2, node]).T <span class="co"># Transpose of Rotation Matrix</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>nn_rot <span class="op">=</span> nn <span class="op">@</span> RT</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> show_plot:</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(nn_rot[<span class="dv">0</span>])</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">4</span>,<span class="dv">4</span>))</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">111</span>, projection<span class="op">=</span><span class="st">'3d'</span>)</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>    ax.scatter(    nn[:,<span class="dv">0</span>],     nn[:,<span class="dv">1</span>],     nn[:,<span class="dv">2</span>], <span class="st">'.'</span>, color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>    ax.scatter(nn_rot[:,<span class="dv">0</span>], nn_rot[:,<span class="dv">1</span>], nn_rot[:,<span class="dv">2</span>], <span class="st">'.'</span>, color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>    ax.scatter(    nn[<span class="dv">0</span>,<span class="dv">0</span>],     nn[<span class="dv">0</span>,<span class="dv">1</span>],     nn[<span class="dv">0</span>,<span class="dv">2</span>], <span class="st">'.'</span>, color<span class="op">=</span><span class="st">'r'</span>, s<span class="op">=</span>[<span class="dv">50</span>], marker<span class="op">=</span><span class="st">'x'</span>)</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>    ax.scatter(nn_rot[<span class="dv">0</span>,<span class="dv">0</span>], nn_rot[<span class="dv">0</span>,<span class="dv">1</span>], nn_rot[<span class="dv">0</span>,<span class="dv">2</span>], <span class="st">'.'</span>, color<span class="op">=</span><span class="st">'g'</span>, s<span class="op">=</span>[<span class="dv">50</span>], marker<span class="op">=</span><span class="st">'x'</span>)</span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>    ax.scatter(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="st">'.'</span>, color<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>    ax.set_zlim(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>nn_proj <span class="op">=</span> nn_rot[:,:<span class="dv">2</span>]</span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>dist_mat <span class="op">=</span> dist(nn_proj, nn_proj)</span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>scale <span class="op">=</span> np.<span class="bu">max</span>(dist_mat)</span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>dist_mat <span class="op">/=</span> scale</span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>rhs <span class="op">=</span> Lrbf(dist_mat[<span class="dv">0</span>], eps)</span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> rbf(dist_mat, eps)</span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'cond(A) = </span><span class="sc">%g</span><span class="ch">\n</span><span class="st">'</span> <span class="op">%</span> la.cond(A))</span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>ws <span class="op">=</span> la.solve(A, rhs)[:n]<span class="op">/</span>scale<span class="op">**</span><span class="dv">2</span></span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a>L_approx <span class="op">=</span> np.dot(ws, [forcing(node) <span class="cf">for</span> node <span class="kw">in</span> nn])</span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a>L_actual <span class="op">=</span> exact(nn[<span class="dv">0</span>])</span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Approximated Laplacian = </span><span class="sc">%g</span><span class="st">'</span> <span class="op">%</span> L_approx)</span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Actual Laplacian = </span><span class="sc">%g</span><span class="ch">\n</span><span class="st">'</span> <span class="op">%</span> L_actual)</span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Relative error = </span><span class="sc">%g</span><span class="st">'</span> <span class="op">%</span> np.<span class="bu">abs</span>((L_approx <span class="op">-</span> L_actual)<span class="op">/</span>L_actual))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>cond(A) = 1.05533e+13

Approximated Laplacian = 1.26093
Actual Laplacian = 1.26092

Relative error = 8.03987e-06</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>
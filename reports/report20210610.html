<html>

<head>
    <link rel="stylesheet" href="../main.css">
    
    <!-- Mathjax scripts -->
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
        });
    </script>
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    <!-- Mathjax commands -->
    $
    \newcommand{\RR}{\mathbb{R}}
    \newcommand{\NN}{\mathbb{N}}
    \newcommand{\OO}{\mathcal{O}}
    \newcommand{\mathcow}{\OO}
    \newcommand{\QQ}{\mathbb{Q}}
    \newcommand{\ZZ}{\mathbb{Z}}
    \newcommand{\CC}{\mathbb{C}}
    \newcommand{\KK}{\mathbb{K}}
    \newcommand{\PP}{\mathcal{P}}
    \newcommand{\TT}{\mathcal{T}}
    \newcommand{\BB}{\mathcal{B}}
    \newcommand{\LL}{\mathcal{L}}
    \renewcommand{\Re}{\operatorname{Re}}
    \renewcommand{\Im}{\operatorname{Im}}

    \newcommand{\veca}{\vec{a}}
    \newcommand{\vecb}{\vec{b}}
    \newcommand{\vecd}{\vec{d}}
    \newcommand{\vece}{\vec{e}}
    \newcommand{\vecf}{\vec{f}}
    \newcommand{\vecn}{\vec{n}}
    \newcommand{\vecp}{\vec{p}}
    \newcommand{\vecr}{\vec{r}}
    \newcommand{\vecu}{\vec{u}}
    \newcommand{\vecv}{\vec{v}}
    \newcommand{\vecx}{\vec{x}}
    \newcommand{\vecy}{\vec{y}}
    \newcommand{\vecz}{\vec{z}}

    \renewcommand{\vec}[1]{\mathbf{#1}}
    $

    <!-- Plotly code for interactive plots -->
    <script src="../plotly-2.0.0-rc.2.min.js"></script>
    
    <!--Prisim for code highlighting -->
    <script src="../prism.js"></script>    
    <link rel="stylesheet" href="../prism.css">



    
<!--************************************************************************-->
<title>Shaw Research Notes</title>
</head>
<!--***************************************************************************
*******************************************************************************
****************************************************************************-->

<body>

<div class="top-bar">
    <a href="../index.html"><img src="../frame/boulder-logo.png"></a>
</div>

<div id="side-bar" class="side-bar">
    <p><a href="../reports/reports.html" target="_top">Reports</a></p>
    <p><a href="../todo/todo.html" target="_top">To Do List</a></p>
    <p><a href="../about/about.html" target="_top">About</a></p>
    <hr>
    <p><a href="../old-rbf/index.html" target="_top">Old Site</a></p>
</div>

<div class="page-content">
<!--***************************************************************************
*******************************************************************************
****************************************************************************-->

<h1 id="Title">June 10<sup>th</sup>, 2021</h1>
<p id="summary">
    Lorem
</p>

<hr><!--********************************************************************-->
<h1 id="">To-Do List Snapshot</h1>
<p>
<ul>
    <li>Investigate wave-response function.</li>
    <ul>
        <li>Spatially homogeneous pulse.</li>
        <li>Spatially homogeneous, temporally finite.</li>
        <li>Local pulses.</li>
    </ul>
    <li>Wave-train Analysis</li>
    <ul>
        <li>Search the literature.</li>
        <li>Find periodic solutions.</li>
        <li>Compare frequency to a pair of pulses.</li>
    </ul>
    <li>Reading</li>
    <ul>
        <li>Coombes 2004.</li>
        <li>Folias &amp; Bressloff 2005.</li>
        <li>Faye &amp; Kilpatrick 2018.</li>
    </ul>
</ul>
</p>

<hr><!--********************************************************************-->

<h1 id="">Parameter Search</h1>
<p>
    Lorem
</p>

<div id="slider-plot" style="width:auto;"></div>

<!--************************************************************************-->

<hr><!--********************************************************************-->

<h1 id="">Wave Response: Adjoint Method</h1>
<p>
    Beginning with the model
$$\begin{align*}
    \mu u_t &= -u + \int_\RR w(x,y) f\big[ u(y,t) - a(y,t) \big] \ dy + \epsilon I(\xi, t) \\
    \alpha   a_t &= -a + \gamma \int_\RR w(x,y) f\big[ u(y,t) - a(y,t) \big] \ dy
\end{align*}$$
</p>

<p>
We convert to $\xi$-$t$ coordinates via the mappings $x-ct \mapsto \xi$ and $t \mapsto t$
$$\begin{align*}
    -c\mu u_\xi + \mu u_t &= -u + \int_\RR w(\xi,y) f\big[ u(y,t) - a(y,t) \big] \ dy + \epsilon I(\xi, t) \\
    -c\alpha a_\xi + \alpha a_t &= -a + \gamma \int_\RR w(\xi,y) f\big[ u(y,t) - a(y,t) \big] \ dy.
\end{align*}$$
</p>
<p>
    Then we make the asymptotic approximation
$$\begin{align*}
    u(\xi, t) &= U(\xi - \epsilon \nu(t)) + \epsilon u_1(\xi, t) + \OO(\epsilon^2) \\
    a(\xi, t) &= A(\xi - \epsilon \eta(t)) + \epsilon a_1(\xi, t) + \OO(\epsilon^2).
\end{align*}$$
giving us
$$\begin{align*}
    -c\mu (U_\xi + \epsilon \partial_\xi u_{1}) + \mu (-\epsilon \nu_t U_\xi + \epsilon \partial_t u_{1}) &= -U -\epsilon u_1 + \int_\RR w(\xi,y) \bigg[ f\big(U(y) - A(y)\big) + \epsilon f'(U-A)(u_1 - a_1) \bigg] \ dy + \epsilon I(\xi, t) + \OO(\epsilon^2)\\
    -c\alpha (A_\xi + \epsilon \partial_\xi a_{1}) + \alpha (-\epsilon \eta_t A_\xi + \epsilon \partial_t a_{1}) &= -A - \epsilon a_1+ \gamma \int_\RR w(\xi,y)  \bigg[ f\big(U(y) - A(y)\big) + \epsilon f'(U-A)(u_1 - a_1) \bigg] \ dy + \OO(\epsilon^2)\\
\end{align*}$$
</p>
<p>
    Collecting the $\OO(1)$ terms, we have
$$\begin{align*}
    -c\mu U_\xi &= -U + \int_\RR w(\xi, y) f\big[ U(y) - A(y) \big] \ dy \\
    -c\alpha A_\xi &= -A + \gamma \int_\RR w(\xi, y) f\big[U(y) - A(y) \big] \ dy,
\end{align*}$$
and thus $U$ and $A$ are the profiles of stable traveling pulses.
</p>
<p>
    Collecting the $\OO(\epsilon)$ terms, we have
$$\begin{align*}
    \mu \partial_t u_1 + u_1 - \mu c\partial_\xi u_1 - \int_\RR w(\xi, y) f'\big(U(y)-A(y)\big) \big(u_1(y,t) - a_1(y,t)\big) \ dy 
        &= -\mu U_\xi \nu_t + I \\
    \alpha \partial_t a_1 + a_1 - \alpha c \partial_\xi a_1 - \gamma \int_\RR w(\xi, y) f'\big(U(y)-A(y)\big) \big(u_1(y,t) - a_1(y,t)\big) \ dy 
    &= -\alpha A_\xi \eta_t
\end{align*}$$
or in vector form
$$\begin{align*}
    \begin{bmatrix}\mu&0\\0&\alpha\end{bmatrix} \vecu_t + \underbrace{\vecu - c\begin{bmatrix}\mu&0\\0&\alpha\end{bmatrix} \vecu_\xi - \begin{bmatrix}1&-1\\ \gamma&-\gamma\end{bmatrix} \int_\RR w(\xi,y)f'\big(U(y) - A(y)\big)  \vecu(y) \ dy}_{\LL \vecu} &= \begin{bmatrix}-\mu U_\xi \nu_t + I \\ -\alpha A_\xi \eta_t \end{bmatrix}
\end{align*}$$
with $\vecu^T = [u_1, a_1]$.
</p>
<p>
    A bounded solution will exist if the right-hand-side is orthogonal to the null-space of
$$
    \LL^* \vecv = \vecv   + c \begin{bmatrix}\mu&0\\0&\alpha\end{bmatrix} \vecv_\xi - f'\big(U(\xi) - A(\xi)\big) \begin{bmatrix}1&\gamma \\ -1 &-\gamma\end{bmatrix} \int_\RR w(y, \xi) \vecv(y) \ dy.
$$
</p>

    <button class="accordion">Adjoint Derivation</button> <!-- Begin Adjoint Derivation -->
    <div class="panel">
        We begin by defining the matrices
$$
M_1 = \begin{bmatrix}\mu&0\\0&\alpha\end{bmatrix}, \qquad \text{ and } \qquad M_2 = \begin{bmatrix}1&-1\\ \gamma&-\gamma\end{bmatrix},
$$
for convenience. Then we have
$$
\begin{align*}
    \langle \LL \vecu, \vecv \rangle &= \int_\RR \LL \vecu \cdot \vecv \ d\xi \\
        &= \int_\RR \vecv^T \vecu - c\vecv^T M_1 \vecu_\xi - \vecv^T M_2 \int_\RR w(\xi, y) f'\big(U(y) - A(y)\big) \vecu(y) \ dy \ d\xi \\
        &= \int_\RR \vecv^T \vecu \ d\xi - c \int_\RR \vecv^T M_1 \vecu_\xi \ d\xi - \int_\RR  \int_\RR w(\xi, y) f'\big(U(y) - A(y)\big) \ \vecv^T M_2 \vecu(y) \ dy \ d\xi \\
        &= \int_\RR \vecv^T \vecu \ d\xi - c\vecv^TM_1\vecu \bigg|_{-\infty}^\infty  + c\int_\RR \vecv^T_\xi M_1 \vecu \ d\xi - \int_\RR  \int_\RR w(\xi, y) f'\big(U(y) - A(y)\big) \ \vecv^T(\xi) M_2 \vecu(y) \ dy \ d\xi \tag{IBP} \\
        &= - c\vecv^TM_1\vecu \bigg|_{-\infty}^\infty + \int_\RR \vecv^T \vecu \ d\xi   + c\int_\RR \vecv^T_\xi M_1 \vecu \ d\xi - \int_\RR  \int_\RR w(y, \xi) f'\big(U(\xi) - A(\xi)\big) \ \vecv^T(y) M_2 \vecu(\xi) \ dy \ d\xi \tag{change of varialbes} \\
        &= - c\vecu^TM_1^T\vecv \bigg|_{-\infty}^\infty + \int_\RR \vecu^T \vecv \ d\xi   + c\int_\RR \vecu^T M_1^T \vecv_\xi \ d\xi - \int_\RR  \int_\RR w(y, \xi) f'\big(U(\xi) - A(\xi)\big) \ \vecu^T(\xi) M_2^T \vecv(y) \ dy \ d\xi \tag{transpose of scalars} \\
        &= - c\vecu^TM_1^T\vecv \bigg|_{-\infty}^\infty + \int_\RR \vecu^T\bigg( \vecv   + c M_1^T \vecv_\xi - f'\big(U(\xi) - A(\xi)\big)\int_\RR w(y, \xi)  \ M_2^T \vecv(y) \ dy \ \bigg)d\xi.
\end{align*}$$
Assuming that $c\vecu^TM_1^T\vecv \bigg|_{-\infty}^\infty = 0$ this gives us
$$
    \LL^* \vecv = \vecv   + c M_1^T \vecv_\xi - f'\big(U(\xi) - A(\xi)\big)\int_\RR w(y, \xi)  \ M_2^T \vecv(y) \ dy
$$
or
$$
    \LL^* \vecv = \vecv   + c \begin{bmatrix}\mu&0\\0&\alpha\end{bmatrix} \vecv_\xi - f'\big(U(\xi) - A(\xi)\big)\int_\RR w(y, \xi)  \begin{bmatrix}1&\gamma \\ -1 &-\gamma\end{bmatrix} \vecv(y) \ dy.
$$
    </div> <!-- End Adjoint Derivation -->

<p>
    Let $\vecv = [v_1, v_2]^T \in \text{Null}(\LL^*)$. We require
$$\begin{align*}
    \vec{0} &= \left\langle \vecv, \begin{bmatrix}-\mu U_\xi \nu_t + I \\ -\alpha A_\xi \eta_t \end{bmatrix} \right\rangle \\
        &= \int_\RR -\mu U_\xi \nu_t v_1(\xi) + v_1(\xi, t)I(\xi, t) -\alpha A_\xi \eta_t v_2(\xi,t) \ d\xi \\
    \left( \int_\RR \mu U_\xi  v_1(\xi) \ d\xi \right) \nu_t + \left( \int_\RR \alpha A_\xi  v_2(\xi) \ d\xi \right) \eta_t&= \int_\RR v_1(\xi) I(\xi, t) \ d\xi
\end{align*}$$
</p> 

<p>
    We can find $\nu_t$ and $\eta_t$ as the solution to the set of equations
$$
    \left( \int_\RR \mu U_\xi  v_1(\xi) \ d\xi \right) \nu_t + \left( \int_\RR \alpha A_\xi  v_2(\xi,t) \ d\xi \right) \eta_t = \int_\RR v_1(\xi) I(\xi, t) \ d\xi
$$
for all vectors $\vecv = [v_1, v_2]^T \in \text{Null}(\LL^*)$.
</p>

<h2 id="">Heaviside Firing-rate with Exponential Weight</h2>
<p>
    In the case of 
$$\begin{align*}
    f(\cdot) &= H(\cdot - \theta) & w(x,y) &= \tfrac{1}{2} e^{-|x-y|}
\end{align*}$$
we find
$$\begin{align*}
    v_1(\xi) &= \alpha H(\xi) e^{-\xi/c\mu} \\
    v_2(\xi) &= -\mu H(\xi) e^{-\xi/c\alpha}.
\end{align*}$$
</p>

<button class="accordion">Null-Space Derivation</button> <!-- Begin Null-space Derivation -->
<div class="panel">
We can compute the null-space as follows:
$$\begin{align*}
    \vec{0} &= \LL^* \vecv \\
        &= \vecv + c \begin{bmatrix}\mu&0\\0&\alpha\end{bmatrix} \vecv_\xi - \frac{d}{d \xi}\bigg[ H\big( U(\xi) - A(\xi) \big) \bigg]  \begin{bmatrix}1&\gamma \\ -1 &-\gamma \end{bmatrix} \int_\RR e^{-|y-\xi |}\vecv(y) \ dy \\
        &= \vecv + c \begin{bmatrix}\mu&0\\0&\alpha\end{bmatrix} \vecv_\xi - \frac{\delta(\xi)}{U'(0) - A'(0)} \begin{bmatrix}1&\gamma \\ -1 &-\gamma \end{bmatrix} \int_\RR e^{-|y|}\vecv(y) \ dy \\
    \vecv + c\begin{bmatrix}\mu&0\\0&\alpha\end{bmatrix} \vecv_\xi &= \frac{\delta(\xi)}{U'(0) - A'(0)} \begin{bmatrix}1&\gamma \\ -1 &-\gamma \end{bmatrix} \int_\RR e^{-|y|}\vecv(y) \ dy \\
    \vecv_\xi + \frac{1}{c} \begin{bmatrix}\mu&0\\0&\alpha\end{bmatrix}^{-1} \vecv &=  \frac{\delta(\xi)}{U'(0) - A'(0)} \begin{bmatrix}\frac{1}{\mu} &\frac{\gamma}{\mu} \\ -\frac{1}{\alpha} &-\frac{\gamma}{\alpha} \end{bmatrix} \int_\RR e^{-|y|}\vecv(y) \ dy \\
    \left[  \exp\left(\frac{\xi}{c} \begin{bmatrix}\mu&0\\0&\alpha\end{bmatrix}^{-1} \right) \vecv \right]_\xi &= \exp\left(\frac{\xi}{c} \begin{bmatrix}\mu&0\\0&\alpha\end{bmatrix}^{-1} \right) \frac{\delta(\xi)}{U'(0) - A'(0)} \begin{bmatrix}\frac{1}{\mu} &\frac{\gamma}{\mu} \\ -\frac{1}{\alpha} &-\frac{\gamma}{\alpha} \end{bmatrix} \int_\RR e^{-|y|}\vecv(y) \ dy \\
    \exp\left(\frac{\xi}{c} \begin{bmatrix}\mu&0\\0&\alpha\end{bmatrix}^{-1} \right) \vecv &= H(\xi) \left[ \exp\left(\frac{\xi}{c} \begin{bmatrix}\mu&0\\0&\alpha\end{bmatrix}^{-1} \right) \frac{1}{U'(0) - A'(0)} \begin{bmatrix}\frac{1}{\mu} &\frac{\gamma}{\mu} \\ -\frac{1}{\alpha} &-\frac{\gamma}{\alpha} \end{bmatrix} \int_\RR e^{-|y|}\vecv(y) \ dy \right]_{\xi = 0} \\
    \exp\left(\frac{\xi}{c} \begin{bmatrix}\mu&0\\0&\alpha\end{bmatrix}^{-1} \right) \vecv &= H(\xi) \frac{1}{U'(0) - A'(0)} \begin{bmatrix}\frac{1}{\mu} &\frac{\gamma}{\mu} \\ -\frac{1}{\alpha} &-\frac{\gamma}{\alpha} \end{bmatrix} \int_\RR e^{-|y|}\vecv(y) \ dy.
\end{align*}$$
</p>

<p>
    The integral on the right-hand-side is some constant vector
$$
    \frac{1}{U'(0) - A'(0)} \int_\RR e^{-|y|}\vecv(y) \ dy = \begin{bmatrix} w_1 \\ w_2 \end{bmatrix}
$$
so we have
\begin{align*}
    \vecv(\xi) &= H(\xi) \exp\left(-\frac{\xi}{c} \begin{bmatrix}\mu&0\\0&\alpha\end{bmatrix}^{-1} \right) \begin{bmatrix}\frac{1}{\mu} &\frac{\gamma}{\mu} \\ -\frac{1}{\alpha} &-\frac{\gamma}{\alpha} \end{bmatrix} \begin{bmatrix} w_1 \\ w_2 \end{bmatrix}.
\end{align*}
</p>

<p>
    This constant matrix is rank 1 and thus the null-space of $\LL^*$ is one-dimensional. Fixing the arbitrary scaling of the null-vector, we arrive at
$$\begin{align*}
    \vecv(\xi) &= H(\xi) \exp\left(-\frac{\xi}{c} \begin{bmatrix}\mu&0\\0&\alpha\end{bmatrix}^{-1} \right) \begin{bmatrix} \alpha \\ -\mu \end{bmatrix}
\end{align*}$$
or equivalently
$$\begin{align*}
    v_1(\xi) &= \alpha H(\xi) e^{-\xi/c\mu} \\
    v_2(\xi) &= -\mu H(\xi) e^{-\xi/c\alpha}.
\end{align*}$$
</p>
</div><!-- End Null-space Derivation -->

<p>
    Conveniently, $A(\xi)$ and $v_2(\xi)$ are orthogonal, and thus we simplify to
$$\begin{align*}
\nu(t) &= \frac{ \int_0^t \int_\RR \alpha H(\xi) e^{-\xi/c\mu} I(\xi, \tau) \ d\xi \ d\tau}{\int_\RR \mu U_\xi \alpha H(\xi) e^{-\xi/c\mu} d\xi}  \\
    &= \frac{1}{\mu} \frac{\int_0^t \int_0^\infty e^{-\xi/c\mu} I(\xi, t) \ d\xi \ d\tau }{\int_\RR U_\xi e^{-\xi/c\mu} d\xi } \\
    &= \frac{2(\mu c+1)}{\mu(e^{-\Delta}-1)} \frac{ \int_0^t \int_0^\infty e^{-\xi/c\mu} I(\xi, t) \ d\xi \ d\tau }{\int_\RR e^{-\xi(1+1/c\mu)} d\xi} \\
    &= \frac{2(\mu c+1)}{\mu(1 - e^{-\Delta})} (1 + \tfrac{1}{c\mu}) \int_0^t \int_0^\infty e^{-\xi/c\mu} I(\xi, t) \ d\xi \ d\tau \\
    &= \frac{2(\mu c+1)^2}{\mu^2 c (1 - e^{-\Delta})} \int_0^t \int_0^\infty e^{-\xi/c\mu} I(\xi, t) \ d\xi \ d\tau.
\end{align*}$$
</p>
<p>
    From the previous report we have that $1 - e^{-\Delta} = 2\theta(\mu c + 1)$ and thus we have
$$
    \nu(t) = \frac{\mu c+1}{\mu^2 c \theta} \int_0^t \int_0^\infty e^{-\xi/c\mu} I(\xi, t) \ d\xi \ d\tau
$$
</p>    

<h3 id="">Spatially Homogeneous Stimulus</h3>
<p>
    If we consider stimuli of the form $I(\xi, t) = I_0 \delta(t)$ then we have
$$\begin{align*}
    \nu(t) &= \frac{\mu c+1}{\mu^3 c^2 \theta} I_0.
\end{align*}$$
</p>




<!--

\begin{bmatrix}\mu&0\\0&\alpha\end{bmatrix}



\begin{bmatrix}1&-1\\ \gamma&-\gamma\end{bmatrix}

\begin{bmatrix}1&\gamma \\ -1 &-\gamma \end{bmatrix}

\begin{bmatrix}\frac{1}{\mu} &\frac{\gamma}{\mu} \\ -\frac{1}{\alpha} &-\frac{\gamma}{\alpha} \end{bmatrix}

-->

<!--div id="slider-plot" style="width:auto;"></div>
<script src="./report20210610/param_plot.js"></script-->

<!--************************************************************************-->

<!--***************************************************************************
*******************************************************************************
****************************************************************************-->
</div>

<!-- Accordion script -->
<script>
var acc = document.getElementsByClassName("accordion");
var i;

for (i = 0; i < acc.length; i++) {
  acc[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var panel = this.nextElementSibling;
    if (panel.style.display === "block") {
      panel.style.display = "none";
    } else {
      panel.style.display = "block";
    }
  });

var expand_all_accordions = false;

if (expand_all_accordions){
    for (i = 0; i < acc.length; i++) {
      acc[i].nextElementSibling.style.display = "block";
    }
}

}
</script>

</body>
    
</html>

<html>

<head>
    <link rel="stylesheet" href="../main.css">
    
    <!-- Mathjax scripts -->
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
        });
    </script>
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    <!-- Mathjax commands -->
    $
    \newcommand{\RR}{\mathbb{R}}
    \newcommand{\NN}{\mathbb{N}}
    \newcommand{\OO}{\mathcal{O}}
    \newcommand{\mathcow}{\OO}
    \newcommand{\QQ}{\mathbb{Q}}
    \newcommand{\ZZ}{\mathbb{Z}}
    \newcommand{\CC}{\mathbb{C}}
    \newcommand{\KK}{\mathbb{K}}
    \newcommand{\PP}{\mathcal{P}}
    \newcommand{\TT}{\mathcal{T}}
    \newcommand{\BB}{\mathcal{B}}
    \newcommand{\LL}{\mathcal{L}}
    \renewcommand{\Re}{\operatorname{Re}}
    \renewcommand{\Im}{\operatorname{Im}}

    \newcommand{\veca}{\vec{a}}
    \newcommand{\vecb}{\vec{b}}
    \newcommand{\vecd}{\vec{d}}
    \newcommand{\vece}{\vec{e}}
    \newcommand{\vecf}{\vec{f}}
    \newcommand{\vecn}{\vec{n}}
    \newcommand{\vecp}{\vec{p}}
    \newcommand{\vecr}{\vec{r}}
    \newcommand{\vecu}{\vec{u}}
    \newcommand{\vecv}{\vec{v}}
    \newcommand{\vecw}{\vec{w}}
    \newcommand{\vecx}{\vec{x}}
    \newcommand{\vecy}{\vec{y}}
    \newcommand{\vecz}{\vec{z}}

    \renewcommand{\vec}[1]{\mathbf{#1}}
    $

    <!-- Plotly code for interactive plots -->
    <script src="../plotly-2.0.0-rc.2.min.js"></script>
    
    <!--Prisim for code highlighting -->
    <script src="../prism.js"></script>    
    <link rel="stylesheet" href="../prism.css">



    
<!--************************************************************************-->
<title>Shaw Research Notes</title>
</head>
<!--***************************************************************************
*******************************************************************************
****************************************************************************-->

<body>

<div class="top-bar">
    <a href="../index.html"><img src="../frame/boulder-logo.png"></a>
</div>

<div id="side-bar" class="side-bar">
    <p><a href="../reports/reports.html" target="_top">Reports</a></p>
    <p><a href="../presentations/presentations.html" target="_top">Presentations</a></p>
    <p><a href="../todo/todo.html" target="_top">To Do List</a></p>
    <p><a href="../about/about.html" target="_top">About</a></p>
    <hr>
    <p><a href="../old-rbf/index.html" target="_top">Old Site</a></p>
</div>

<div class="page-content">
<!--***************************************************************************
*******************************************************************************
****************************************************************************-->

<h1 id="Title">Working</h1>
<p id="summary">
   We apply the new wave response differential equation to the problem of apparent motion.
</p>


<div id="slider-plot" style="width:auto;"></div>

<!--************************************************************************-->

<hr>
<!--********************************************************************-->

<h1>The Apparent Motion Stimulus</h1>

<p>
    For the apparent motion experiment, we will select the stimulus to have certain properties. It is flashing, so it will be non-zero for a length of time $T_\text{on}$ and will be zero for a length of time $T_\text{off}$. During the on period, the stimulus will be localized and stationary. For this analysis, we will take the spatial profile of the stimulus to be a square pulse. We will call $T = T_\text{on} + T_\text{off}$ the period of the stimulus, and $\frac{1}{T}$ the frequency. Between successive on periods, the stimulus will shift forward by the fixed amount $T\Delta_c$, where $\Delta_c$ is the effective speed of the stimulus.
</p>

<p>
    These criteria give the following formula for the activity stimulus
$$
    I_u(x, t) = I_{(y^* - \Delta_y, y^*)}\left(x - \left\lfloor \frac{t}{T} \right\rfloor T\Delta_c \right) I_{(0, T_\text{on})}\left( t - \left\lfloor \frac{t}{T} \right\rfloor T \right).
$$
We will restrict our analysis to the first period, in which the stimulus simplifies to
\begin{align*}
    I_u(x,t) = \begin{cases}
        I_{(y^* - \Delta_y, y^*)}(x), & t < T_\text{on} \\
        0, & \text{else}.
    \end{cases} \\
    I_u(\xi, t) = \begin{cases}
        I_{(y^* - ct - \Delta_y, y^* - ct)}(\xi), & t < T_\text{on} \\
        0, & \text{else}.
    \end{cases}
\end{align*}
</p>

<h2>Simple Case</h2>
<p>
    Our wave response formula is given by
$$
    D \nu' = \langle v_1, I_u(\xi + \varepsilon \nu, t) \rangle
$$
where $D = -\tau_u \langle v_1, U' \rangle - \tau_q \langle v_2, Q' \rangle$. We will also take $v_1(\xi) \approx v(\xi) = H(\xi) e^{-\xi/c\tau_u}$ since the difference is small and it simplifies the analysis dramatically. 
</p>

<p>
    When evaluating this inner product, the bounds of the integral depend on the relationship between the support of the stimulus and the threshold crossings. Since the threshold crossings change over time, this may result in a piecewise differential equation. In this simplest case we will assume that the fore threshold crossing is in the support of the stimulus for the duration of the on interval. Some other more complicated cases include: the threshold crossing is accelerated past the stimulus, or the threshold crossing is accelerated into the support of the stimulus.
</p>

<p>
    We then have, for $t \in (0, T_\text{on})$, 
\begin{align*}
    D \nu' &= \langle v, I_u(\xi + \varepsilon \nu, t) \rangle \\
        &= \langle H(\xi)e^{-\xi/c\tau_u}, I_{(y^* - ct - \Delta_y, y^* - ct)}(\xi + \varepsilon \nu) \rangle \\
        &= \int_{0}^{y^* - \varepsilon \nu - ct} e^{-\xi/c\tau_u} \ d\xi \\
        &= c \tau_u \left(1 - e^{-y^*/c\tau_u} e^{\frac{\varepsilon \nu + ct}{c\tau_u}} \right).
\end{align*}
We next make the change of variables $y = \varepsilon \nu + ct$ which is the location of the front, relative to the stationary stimulus. This gives $y' = \varepsilon \nu' + c$ and
\begin{align*}
    D\frac{y' - c}{\varepsilon} &= c \tau_u \left(1 - e^{-y^*/c\tau_u} e^{\frac{y}{c\tau_u}} \right) \\
    y' &= \underbrace{c + \frac{\varepsilon c\tau_u}{D}}_{a} - \underbrace{\frac{\varepsilon c\tau_u}{D}e^{-y^*}}_{b} e^{y/\underbrace{c\tau_u}_{r}} \\
        &= a - b e^{y/r}.
\end{align*}
</p>

<p>
    We next solve this differential equation with the following change of variables $u = e^{-y/r}$. This gives $u' = -\frac{1}{r}y'u \iff -r \frac{u'}{u} = y'$. Substituting,
\begin{align*}
    -r\frac{u'}{u} &= a - \frac{b}{u} \\
    u' &= \frac{b}{r} - \frac{a}{r}u \\
    u' +\frac{a}{r}u &= \frac{b}{r} \\
    \left[ u e^{at/r} \right]' &= \frac{b}{r}e^{at/r} \\
    u e^{at/r} &= u_0 + \int_{0}^t \frac{b}{r}e^{a\tau/r} \ d\tau \\
    u e^{at/r} &= u_0 + \frac{b}{a}\left( e^{at/r} - 1\right) \\
    u(t) &= \frac{b}{a} + \left(u_0 - \frac{b}{a} \right)e^{-at/r} \\
    e^{-y/r} &= \frac{b}{a} + \left(e^{-y_0/r} - \frac{b}{a} \right)e^{-at/r} \\
    y(t) &= -r \log\left[ \frac{b}{a} + \left(e^{-y_0/r} - \frac{b}{a} \right)e^{-at/r} \right] \\
        &= -c\tau_u \log\left[ \frac{\varepsilon \tau_u}{D + \varepsilon \tau_u}e^{-y^*/c\tau_u} + \left(e^{-y_0/c\tau_u} - \frac{\varepsilon \mu}{D + \varepsilon \mu}e^{-y^*/c\tau_u} \right)e^{-\frac{D+\varepsilon \tau_u}{D\tau_u}t} \right].
\end{align*}
</p>

<p>
    During $t \in (T_\text{on}, T)$, the formula is much simpler, since $\nu' = 0 \iff y' = c.$ Thus, after a full period we have
$$
    y(T) = -c\tau_u \log\left[ \frac{\varepsilon \tau_u}{D + \varepsilon \tau_u}e^{-y^*/c\tau_u} + \left(e^{-y_0/c\tau_u} - \frac{\varepsilon \mu}{D + \varepsilon \mu}e^{-y^*/c\tau_u} \right)e^{-\frac{D+\varepsilon \tau_u}{D\tau_u}T_\text{on}} \right] + cT_\text{off}.
$$
</p>

<!--################################-->
<h3>Initial value mapping</h3>
<p>
Repeating this work on the next period is the same, but we map $y(T) \to y_0$ and shift coordinates forward. This motivates the mapping
$$
    f(y_0) = -c\tau_u \log\left[ \frac{\varepsilon \tau_u}{D + \varepsilon \tau_u}e^{-y^*/c\tau_u} + \left(e^{-y_0/c\tau_u} - \frac{\varepsilon \mu}{D + \varepsilon \mu}e^{-y^*/c\tau_u} \right)e^{-\frac{D+\varepsilon \tau_u}{D\tau_u}T_\text{on}} \right] + cT_\text{off} - (c + \Delta_c)T.
$$
</p>

<p>
A fixed point of this function represents a periodic solution in the moving (discrete jumping) stimulus coordinate frame. We require first that fixed point iteration converges to a fixed point, and second that the fixed point is in the interval $(y^* - \Delta_y, y^*)$ so that our assumptions for this case remain valid.
</p>

<p>
We first find the fixed point $z$,
\begin{align*}
    z &= f(z) = -c\tau_u \log\left[ \underbrace{\frac{\varepsilon \tau_u}{D + \varepsilon \tau_u}e^{-y^*/c\tau_u}}_{A} + \left(e^{-z/c\tau_u} - \underbrace{\frac{\varepsilon \mu}{D + \varepsilon \mu}e^{-y^*/c\tau_u}}_{A} \right)\underbrace{e^{-\frac{D+\varepsilon \tau_u}{D\tau_u}T_\text{on}}}_{B} \right] + \underbrace{cT_\text{off} - (c + \Delta_c)T}_{K} \\
        &= -c\tau_u \log\left[(1-B)A + Be^{-z/c\tau_u} \right] + K \\
    -\frac{z}{c\tau_u} &= \log\left[(1-B)A + Be^{-z/c\tau_u} \right] - \frac{K}{c\tau_u} \\
    e^{-z/c\tau_u} &= e^{-K/c\tau_u} \left((1-B)A + Be^{-z/c\tau_u} \right) \\
    \left(1 - Be^{-K/c\tau_u}\right)e^{-z/c\tau_u} &= (1-B)Ae^{-K/c\tau_u} \\
    e^{-z/c\tau_u} &= \frac{1 - B}{e^{K/c\tau_u} - B}A \\
    e^{-z/c\tau_u} &= \frac{1 - B}{e^{K/c\tau_u} - B} \frac{\varepsilon \mu}{D + \varepsilon \mu} e^{-y^*/c\tau_u} \\
    z &= y^* - c\tau_u \log\left[ \frac{1 - B}{e^{K/c\tau_u} - B} \frac{\varepsilon \mu}{D + \varepsilon \mu} \right].
\end{align*}
</p>

<p>
    We check convergence of the iteration. We first note that $A, B > 0 > K$ and $B \lt 1$ provided $\mu > 1$. We proceed
\begin{align*}
    1 > |f'(z)|\\
         &= \left| -c\tau_u \frac{1}{\left|(1-B)A + Be^{-z/c\tau_u}\right|}B\frac{-1}{c\tau_u}e^{-z/c\tau_u} \right| \\
        &= \frac{B}{(1-B)A e^{z/c\tau_u} + B} \\
    (1-B)A e^{z/c\tau_u} + B > B \\
    (1-B)A e^{z/c\tau_u} > 0
\end{align*}
which is satisfied for any choice of parameters.
</p>

<p>
    Entrainment is thus determined by the second condition. Namely, The pulse will entrain if $z \in (y^* - \Delta_y, y^*)$. If the fixed point is not in this interval, then we must turn to other cases.
</p>

<!--button class="accordion">BUTTON NAME</button>
<div class="panel">
</div-->

<!--video controls autoplay muted loop>
    <source src="../report20230512/synaptic_depression_perturbation.mp4" type="video/mp4">
    Your browser does not support the video tag.
</video-->

<!--figure>
    <img src="../report20230512/wave_response_small.png" width="100%"/>
    <caption><b>Fig 2.</b> The asymptotic approximation of the wave response to $\epsilon I(x, t) = 0.01 \delta(t - 1)$.</caption>
</figure=-->

<!--************************************************************************-->

<!--***************************************************************************
*******************************************************************************
****************************************************************************-->
</div>

<!-- Accordion script -->
<script>
var acc = document.getElementsByClassName("accordion");
var i;

for (i = 0; i < acc.length; i++) {
  acc[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var panel = this.nextElementSibling;
    if (panel.style.display === "block") {
      panel.style.display = "none";
    } else {
      panel.style.display = "block";
    }
  });

var expand_all_accordions = true;

if (expand_all_accordions){
    for (i = 0; i < acc.length; i++) {
      acc[i].nextElementSibling.style.display = "block";
    }
}

}
</script>

<!-- Tabs script -->
<script>
function openTab(evt, tabId) {
  // Declare all variables
  var i, tabcontent, tablinks;

  // Get all elements with class="tabcontent" and hide them
  tabcontent = document.getElementsByClassName("tabcontent");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }

  // Get all elements with class="tablinks" and remove the class "active"
  tablinks = document.getElementsByClassName("tablinks");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }

  // Show the current tab, and add an "active" class to the button that opened the tab
  document.getElementById(tabId).style.display = "block";
  evt.currentTarget.className += " active";
}
</script>

</body>
    
</html>

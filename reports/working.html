<html>

<head>
    <link rel="stylesheet" href="../main.css">
    
    <!-- Mathjax scripts -->
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
        });
    </script>
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    <!-- Mathjax commands -->
    $
    \newcommand{\RR}{\mathbb{R}}
    \newcommand{\NN}{\mathbb{N}}
    \newcommand{\OO}{\mathcal{O}}
    \newcommand{\mathcow}{\OO}
    \newcommand{\QQ}{\mathbb{Q}}
    \newcommand{\ZZ}{\mathbb{Z}}
    \newcommand{\CC}{\mathbb{C}}
    \newcommand{\KK}{\mathbb{K}}
    \newcommand{\PP}{\mathcal{P}}
    \newcommand{\TT}{\mathcal{T}}
    \newcommand{\BB}{\mathcal{B}}
    \newcommand{\LL}{\mathcal{L}}
    \renewcommand{\Re}{\operatorname{Re}}
    \renewcommand{\Im}{\operatorname{Im}}

    \newcommand{\veca}{\vec{a}}
    \newcommand{\vecb}{\vec{b}}
    \newcommand{\vecd}{\vec{d}}
    \newcommand{\vece}{\vec{e}}
    \newcommand{\vecf}{\vec{f}}
    \newcommand{\vecn}{\vec{n}}
    \newcommand{\vecp}{\vec{p}}
    \newcommand{\vecr}{\vec{r}}
    \newcommand{\vecu}{\vec{u}}
    \newcommand{\vecv}{\vec{v}}
    \newcommand{\vecw}{\vec{w}}
    \newcommand{\vecx}{\vec{x}}
    \newcommand{\vecy}{\vec{y}}
    \newcommand{\vecz}{\vec{z}}

    \renewcommand{\vec}[1]{\mathbf{#1}}
    $

    <!-- Plotly code for interactive plots -->
    <script src="../plotly-2.0.0-rc.2.min.js"></script>
    
    <!--Prisim for code highlighting -->
    <script src="../prism.js"></script>    
    <link rel="stylesheet" href="../prism.css">



    
<!--************************************************************************-->
<title>Shaw Research Notes</title>
</head>
<!--***************************************************************************
*******************************************************************************
****************************************************************************-->

<body>

<div class="top-bar">
    <a href="../index.html"><img src="../frame/boulder-logo.png"></a>
</div>

<div id="side-bar" class="side-bar">
    <p><a href="../reports/reports.html" target="_top">Reports</a></p>
    <p><a href="../presentations/presentations.html" target="_top">Presentations</a></p>
    <p><a href="../todo/todo.html" target="_top">To Do List</a></p>
    <p><a href="../about/about.html" target="_top">About</a></p>
    <hr>
    <p><a href="../old-rbf/index.html" target="_top">Old Site</a></p>
</div>

<div class="page-content">
<!--***************************************************************************
*******************************************************************************
****************************************************************************-->

<h1 id="Title">Working Report</h1>
<p id="summary">
   Synaptic depression.
</p>


<div id="slider-plot" style="width:auto;"></div>

<!--************************************************************************-->

<hr><!--********************************************************************-->

<h1 id="">Wave response</h1>
<p>
Our neural field model incorporating synaptic depression is given by
$$\begin{align*}
    \mu u_t &= -u + \int_\RR w(x, y) q(y,t) f\big(u(y, t)\big) \ dy + \epsilon I(x, t) \\
    \alpha   q_t &= 1 - q - \alpha\beta q f(u).
\end{align*}$$
</p>

<button class="accordion">Wave Response Derivation</button>
<div class="panel">
<p>
In characteristic coordinates $\xi = x - ct$ (and with slight abuse of notation) this becomes
$$\begin{align*}
    -c \mu u_\xi + \mu u_t &= -u + \int_\RR w(\xi, y) q(y,t) f\big(u(y, t)\big) \ dy + \epsilon I(\xi, t) \\
    -c \alpha q_\xi + \alpha q_t &= 1 - q - \alpha \beta q f(u).
\end{align*}$$
</p>

<p>
Assume our solution has the expansion
$$\begin{align*}
    u(\xi, t) &= U\big( \xi - \epsilon \nu(t) \big) + \epsilon \phi + \OO(\epsilon^2) \\
    q(\xi, t) &= Q\big( \xi - \epsilon \nu(t) \big) + \epsilon \psi + \OO(\epsilon^2)
\end{align*}$$
where $U, Q$ denote our traveling pulse solution.
</p>

<p>
Substituting, and using the linearization $f\big( U + \epsilon \phi + \OO(\epsilon^2) \big) = f(U) + \epsilon f'(U) \phi + \OO(\epsilon^2)$ we have
$$\begin{align*}
    -c\mu (U' + \epsilon \phi_\xi) + \mu (-\epsilon U' \nu' + \epsilon \phi_t)
        &= -U - \epsilon \phi + \int_\RR w(\xi, y)\big[ Q + \epsilon \psi \big] \big[f(U) + \epsilon f'(U) \phi \big] \ dy + \epsilon I + \OO(\epsilon^2) \\
    -c\alpha (Q' + \epsilon \psi_\xi) + \alpha (-\epsilon Q' \nu' + \epsilon \psi_t)
        &= 1 - Q - \epsilon \psi -\alpha \beta \big(Q + \epsilon \psi\big) \big(f(U) + \epsilon f'(U) \phi \big) + \OO(\epsilon^2)
\end{align*}$$
where $U, Q, U'$ and $Q'$ here are understood to be evaluated at $\xi - \epsilon \nu(t)$ (or $y - \epsilon \nu(t)$ when inside the integral).
</p>

<p>
Collecting the $\OO(1)$ terms, and changing variables $\xi - \epsilon \nu(t) \to \xi$ gives
$$\begin{align*}
    -c\mu U' &= -U + \int_\RR w(\xi, y) Q(y) f(U(y)) \ dy \\
    -c\alpha Q' &= 1 - Q - \alpha \beta Q  f(U)
\end{align*}$$
and is consistent with $U, Q$ being the traveling pulse solution.
</p>

<p>
Collecting the $\OO(\epsilon)$ terms gives
$$\begin{align*}
    \mu \phi_t + \phi - c\mu \phi_\xi -\int_\RR w(\xi, y) Q(y)f'\big(U(y)\big) \phi(y,t) \ dy - \int_\RR w(\xi, y) f\big(U(y)\big) \psi(y, t) \ dy
        &= I + \mu U' \nu' \\
    \alpha \psi_t + \psi - c\alpha \psi_\xi + \alpha\beta Q f'(U) \phi + \alpha \beta f(U) \psi
        &= \alpha Q' \nu'.
\end{align*}$$
In vector notation this becomes
$$\begin{align*}
    \underbrace{\begin{bmatrix}\mu & 0 \\ 0 & \alpha\end{bmatrix}}_{M} \begin{bmatrix}\phi \\ \psi \end{bmatrix}_t + \underbrace{ \begin{bmatrix}\phi \\ \psi \end{bmatrix} - c\begin{bmatrix}\mu & 0 \\ 0 & \alpha\end{bmatrix} \begin{bmatrix}\phi \\ \psi \end{bmatrix}_\xi +
        \begin{bmatrix}
            -w Q f'(U) * \cdot  & -w f(U) * \cdot \\
            \alpha \beta Q f'(U) & \alpha \beta f(U)
        \end{bmatrix}
        \begin{bmatrix}\phi \\ \psi \end{bmatrix} }_{\LL \vecu}
        &= 
        \begin{bmatrix} I + \mu U' \nu' \\ \alpha Q' \nu ' \end{bmatrix}
\end{align*}$$
where $\vecu = [\phi, \psi]^T$ and the convolution operators in the matrix are understood to be applied to the elements of the vector rather than multiplied, in the matrix-vector multiplication. 
</p>
<p>
Bounded solutions exist if the right-hand side is orthogonal to the nullspace of $\LL^*$. We next find this adjoint.
</p>

<p>
$$\begin{align*}
    \langle \LL \vecu, \vecv \rangle 
        &= \int \vecv^T \vecu \ d\xi - c\int \vecv^T M \vecu_\xi \ d\xi + \int \vecv^T(\xi) 
                \begin{bmatrix} 
                    \int -w(\xi, y) Q(y) f'\big(U(y)\big) \cdot \ dy & \int -w(\xi, y) f\big(U(y)\big) \cdot \ dy \\
                    \alpha \beta Q f'(U) & \alpha \beta f(U)
                \end{bmatrix}
            \vecu \ d\xi \\
        &= \int \vecu^T \vecv \ d\xi - c \bigg( \underbrace{\vecv^TM\vecu \bigg|_{\xi = -\infty}^\infty}_{=0} - \int \vecu^T M \vecv_\xi \ d\xi \bigg) + \int \vecu^T(y)
                \begin{bmatrix} 
                    - f'\big(U(y)\big) Q(y) \int w(\xi, y)  \cdot d \xi & \alpha \beta Q f'(U) \\
                    - f(\big(U(y)\big) \int w(\xi, y) \cdot d \xi & \alpha \beta f(U) 
                \end{bmatrix}  
            \vecv \ dy \\
        &= \int \vecu^T \vecv \ d\xi + c \int \vecu^T M \vecv_\xi \ d\xi + \int \vecu^T
                \begin{bmatrix} 
                    - f'(U)Q \int w(y, \xi)\cdot d \ y & \alpha \beta Q f'(U) \\
                    - f(U) \int w(y, \xi) \cdot d y & \alpha \beta f(U)
                \end{bmatrix}  
            \vecv \ d\xi \\
    &= \int \vecu^T \bigg( \underbrace{ \vecv + cM\vecv_\xi + 
            \begin{bmatrix} 
                -f'(U)Q \int w(y, \xi) \cdot \ dy & \alpha \beta Q f'(U) \\
                -f(U) \int w(y, \xi) \cdot \ dy & \alpha \beta f(U)
            \end{bmatrix} \vecv }_{\LL^* \vecv} \bigg) \ d\xi \\
    &= \langle \vecu, \LL^* \vecv \rangle
\end{align*}$$
</p>
<p>
Let $[v_1, v_2]^T$ be in the kernel of $\LL^*$. Then they must satisfy
$$\begin{align*}
    -c \mu v_1' &= v_1 -f'(U)Q \int w(y,\xi) v_1(y) \ dy + \alpha \beta Q f'(U)v_2 \\
    -c \alpha v_2' &= v_2 - f(U) \int w(y, \xi) v_1(y) \ dy + \alpha \beta f(U) v_2.
\end{align*}$$
Our orthogonality condition now becomes
$$\begin{align*}
    0 &= \int_\RR v_1(I + \mu U' \nu') + v_2(\alpha Q' \nu') \ d\xi \\
        &= \nu' \int_\RR \mu U' v_1 + \alpha Q' v_2 \ d\xi + \int_\RR v_1 I \ d\xi \\
    \nu'(t) &= - \frac{\int_\RR v_1 I \ d\xi}{\int_\RR \mu U' v_1 + \alpha Q' v_2 \ d\xi} \\
    \nu(t) &= - \frac{\int_\RR v_1 \int_0^t I(\xi, \tau) \ d\tau \ d\xi}{\int_\RR \mu U' v_1 + \alpha Q' v_2 \ d\xi}.
\end{align*}$$
</p>
</div>

<p>
Our wave response function is given by
$$\begin{align*}
    \nu(t) &= - \frac{\int_\RR v_1 \int_0^t I(\xi, \tau) \ d\tau \ d\xi}{\int_\RR \mu U' v_1 + \alpha Q' v_2 \ d\xi}
\end{align*}$$
where $U, Q$ denote the traveling pulse solution, and $v_1, v_2$ satisfy
$$\begin{align*}
    -c \mu v_1' &= v_1 -f'(U)Q \int w(y,\xi) v_1(y) \ dy + \alpha \beta Q f'(U)v_2 \\
    -c \alpha v_2' &= v_2 - f(U) \int w(y, \xi) v_1(y) \ dy + \alpha \beta f(U) v_2.
\end{align*}$$
</p>

<!--************************************************************************-->
<h2>Heaviside Firing Rate and bi-exponential weight kernel</h2>
<p>
Let $f(\cdot) = H(\cdot - \theta)$ and $w(x,y) = \tfrac{1}{2}e^{-|x-y|}$. We have previously computed $U, Q$ for these choices. Note that
\[
    f'(U) = \frac{\delta_{-\Delta}(\xi)}{U'(-\Delta)} + \frac{\delta_{0}(\xi)}{U'(0)}.
\]
</p>

<p>
    Rearranging our equation for $v_1'$ above, we have
$$\begin{align*}
    v_1' + \frac{1}{c\mu} v_1 &= \frac{1}{c\mu}f'(U)Q \bigg[ \int w(y,\xi) v_1(y) \ dy + \alpha \beta v_2 \bigg] \\
    \big[ v_1 e^{(1/c\mu) \xi} \big]' &= e^{1/c\mu \xi}\frac{1}{c\mu}f'(U)Q \bigg[ \int w(y,\xi) v_1(y) \ dy + \alpha \beta v_2 \bigg] \\
    v_1(\xi) &= e^{-(1/c\mu) \xi} \int e^{(1/c\mu) \xi}\frac{1}{c\mu}f'(U)Q \bigg[ \int w(y,\xi) v_1(y) \ dy + \alpha \beta v_2 \bigg] \ d\xi \\
    &= e^{-(1/c\mu) \xi} \bigg[ A_{-\Delta} H(\xi + \Delta) + A_0 H(\xi) \bigg]
\end{align*}$$
where
$$\begin{align*}
    A_{-\Delta} &= e^{-\Delta/c\mu}\frac{1}{c\mu} \frac{1}{U'(-\Delta)} Q(-\Delta)\bigg[ \int w(y, -\Delta) v_1(y) \ dy + \alpha \beta v_2(-\Delta) \bigg] \\
    A_0 &= \frac{1}{c\mu} \frac{1}{U'(0)}Q(0) \bigg[\int w(y, 0) v_1(y) \ dy + \alpha \beta v_2(0) \bigg]
\end{align*}$$
Evaluating the integrals, we have
$$\begin{align*}
    \int_\RR w(y, 0) v_1(y) \ dy &= \int_\RR \tfrac{1}{2}e^{-|y|}e^{-(1/c\mu) y} \big[ A_{-\Delta}H(y + \Delta) + A_0 H(y) \big] \ dy \\
        &= \int_{-\Delta}^0 \tfrac{1}{2}e^{y}e^{-(1/c\mu) y} A_{-\Delta} \ dy + \int_0^\infty \tfrac{1}{2}e^{-y}e^{-(1/c\mu) y} (A_{-\Delta} + A_0) \ dy \\
        &= \tfrac{1}{2}A_{-\Delta} \int_{-\Delta}^0 e^{(c\mu - 1)/c\mu y} \ dy + \tfrac{1}{2}(A_{-\Delta}+A_0) \int_0^\infty e^{-(1+c\mu)/(c\mu) y} \ dy \\
        &= \tfrac{1}{2}A_{-\Delta} \frac{c\mu}{c\mu-1}(1 - e^{-(c\mu-1)/(c\mu)\Delta}) + \tfrac{1}{2}\frac{c\mu}{1+c\mu}(A_{-\Delta} + A_0) \\
    \int_\RR w(y,-\Delta) v_1(y) \ dy &= \int_\RR e^{-1/(c\mu)y} \tfrac{1}{2}e^{-|y+\Delta|}\big[ A_{-\Delta} H(y + \Delta) + A_0 + H(y) \big] \ dy \\
        &= \tfrac{1}{2}e^{-\Delta} \int_{-\Delta}^\infty e^{-(1+c\mu)/(c\mu)y} \big[A_{-\Delta} H(y+\Delta) + A_0 H(y) \big] \ dy \\
        &= \tfrac{1}{2}e^{-\Delta} \bigg[A_{-\Delta} \int_{-\Delta}^0 e^{-(1+c\mu)/(c\mu)y} \ dy + (A_{-\Delta} + A_0)\int_0^\infty e^{-(1+c\mu)/(c\mu)y} \ dy \bigg] \\
        &= \tfrac{1}{2}e^{-\Delta} \bigg[A_{-\Delta} \frac{c\mu}{1+c\mu} \big(1 - e^{(1+c\mu)/(c\mu)\Delta}\big) + (A_{-\Delta} + A_0)\frac{c\mu}{1+c\mu} \bigg]
\end{align*}$$
</p>

<!--************************************************************************-->

<!--***************************************************************************
*******************************************************************************
****************************************************************************-->
</div>

<!-- Accordion script -->
<script>
var acc = document.getElementsByClassName("accordion");
var i;

for (i = 0; i < acc.length; i++) {
  acc[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var panel = this.nextElementSibling;
    if (panel.style.display === "block") {
      panel.style.display = "none";
    } else {
      panel.style.display = "block";
    }
  });

var expand_all_accordions = false;

if (expand_all_accordions){
    for (i = 0; i < acc.length; i++) {
      acc[i].nextElementSibling.style.display = "block";
    }
}

}
</script>

</body>
    
</html>

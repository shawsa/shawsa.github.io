<html>

<head>
    <link rel="stylesheet" href="../main.css">
    
    <!-- Mathjax scripts -->
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
        });
    </script>
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    <!-- Mathjax commands -->
    $
    \newcommand{\RR}{\mathbb{R}}
    \newcommand{\NN}{\mathbb{N}}
    \newcommand{\OO}{\mathcal{O}}
    \newcommand{\mathcow}{\OO}
    \newcommand{\QQ}{\mathbb{Q}}
    \newcommand{\ZZ}{\mathbb{Z}}
    \newcommand{\CC}{\mathbb{C}}
    \newcommand{\KK}{\mathbb{K}}
    \newcommand{\PP}{\mathcal{P}}
    \newcommand{\TT}{\mathcal{T}}
    \newcommand{\BB}{\mathcal{B}}
    \newcommand{\LL}{\mathcal{L}}
    \renewcommand{\Re}{\operatorname{Re}}
    \renewcommand{\Im}{\operatorname{Im}}

    \newcommand{\veca}{\vec{a}}
    \newcommand{\vecb}{\vec{b}}
    \newcommand{\vecd}{\vec{d}}
    \newcommand{\vece}{\vec{e}}
    \newcommand{\vecf}{\vec{f}}
    \newcommand{\vecn}{\vec{n}}
    \newcommand{\vecp}{\vec{p}}
    \newcommand{\vecr}{\vec{r}}
    \newcommand{\vecu}{\vec{u}}
    \newcommand{\vecv}{\vec{v}}
    \newcommand{\vecw}{\vec{w}}
    \newcommand{\vecx}{\vec{x}}
    \newcommand{\vecy}{\vec{y}}
    \newcommand{\vecz}{\vec{z}}

    \renewcommand{\vec}[1]{\mathbf{#1}}
    $

    <!-- Plotly code for interactive plots -->
    <script src="../plotly-2.0.0-rc.2.min.js"></script>
    
    <!--Prisim for code highlighting -->
    <script src="../prism.js"></script>    
    <link rel="stylesheet" href="../prism.css">



    
<!--************************************************************************-->
<title>Shaw Research Notes</title>
</head>
<!--***************************************************************************
*******************************************************************************
****************************************************************************-->

<body>

<div class="top-bar">
    <a href="../index.html"><img src="../frame/boulder-logo.png"></a>
</div>

<div id="side-bar" class="side-bar">
    <p><a href="../reports/reports.html" target="_top">Reports</a></p>
    <p><a href="../presentations/presentations.html" target="_top">Presentations</a></p>
    <p><a href="../todo/todo.html" target="_top">To Do List</a></p>
    <p><a href="../about/about.html" target="_top">About</a></p>
    <hr>
    <p><a href="../old-rbf/index.html" target="_top">Old Site</a></p>
</div>

<div class="page-content">
<!--***************************************************************************
*******************************************************************************
****************************************************************************-->

<h1 id="Title">Working</h1>
<p id="summary">
   We apply the new wave response differential equation to the problem of apparent motion.
</p>


<div id="slider-plot" style="width:auto;"></div>

<!--************************************************************************-->

<hr>
<!--********************************************************************-->

<h1>The Apparent Motion Stimulus</h1>

<p>
    For the apparent motion experiment, we will select the stimulus to have certain properties. It is flashing, so it will be non-zero for a length of time $T_\text{on}$ and will be zero for a length of time $T_\text{off}$. During the on period, the stimulus will be localized and stationary. For this analysis, we will take the spatial profile of the stimulus to be a square pulse. We will call $T = T_\text{on} + T_\text{off}$ the period of the stimulus, and $\frac{1}{T}$ the frequency. Between successive on periods, the stimulus will shift forward by the fixed amount $T\Delta_c$, where $\Delta_c$ is the effective speed of the stimulus.
</p>

<p>
    These criteria give the following formula for the activity stimulus
$$
    I_u(x, t) = I_{(y^* - \Delta_y, y^*)}\left(x - \left\lfloor \frac{t}{T} \right\rfloor (c + \Delta_c)T \right) I_{(0, T_\text{on})}\left( t - \left\lfloor \frac{t}{T} \right\rfloor T \right).
$$
We will restrict our analysis to the first period, in which the stimulus simplifies to
\begin{align*}
    I_u(x,t) = \begin{cases}
        I_{(y^* - \Delta_y, y^*)}(x), & t < T_\text{on} \\
        0, & \text{else}.
    \end{cases} \\
    I_u(\xi, t) = \begin{cases}
        I_{(y^* - ct - \Delta_y, y^* - ct)}(\xi), & t < T_\text{on} \\
        0, & \text{else}.
    \end{cases}
\end{align*}
</p>

<p>
It is helpful to divide the scenario into several cases involving the position of the threshold crossing relative to the active region during the on-interval. We will consider the simplest case first. In the simplest case (Case 1) we will assume that the fore threshold crossing is in the support of the stimulus for the duration of the on interval. In the second case (Case 2) the stimulus jumps beyond the threshold crossing, but the period is long enough for the stimulus to catch up and enter the active region before the stimulus turns off.
</p>

<h2>Case 1: Short Periods</h2>
<p>
In this simplest case we will assume that the fore threshold crossing is in the support of the stimulus for the duration of the on interval. Some other more complicated cases include: the threshold crossing is accelerated past the stimulus, or the threshold crossing is accelerated into the support of the stimulus.
</p>
<p>
    Our wave response formula is given by
$$
    D \nu' = \langle v_1, I_u(\xi + \varepsilon \nu, t) \rangle
$$
where $D = -\tau_u \langle v_1, U' \rangle - \tau_q \langle v_2, Q' \rangle$. We will also take $v_1(\xi) \approx v(\xi) = H(\xi) e^{-\xi/c\tau_u}$ since the difference is small and it simplifies the analysis dramatically. 
</p>

<p>
    When evaluating this inner product, the bounds of the integral depend on the relationship between the support of the stimulus and the threshold crossings. Since the threshold crossings change over time, this may result in a piecewise differential equation. 
</p>

<p>
    We then have, for $t \in (0, T_\text{on})$, 
\begin{align*}
    D \nu' &= \langle v, I_u(\xi + \varepsilon \nu, t) \rangle \\
        &= \langle H(\xi)e^{-\xi/c\tau_u}, I_{(y^* - ct - \Delta_y, y^* - ct)}(\xi + \varepsilon \nu) \rangle \\
        &= \int_{0}^{y^* - \varepsilon \nu - ct} e^{-\xi/c\tau_u} \ d\xi \\
        &= c \tau_u \left(1 - e^{-y^*/c\tau_u} e^{\frac{\varepsilon \nu + ct}{c\tau_u}} \right).
\end{align*}
We next make the change of variables $y = \varepsilon \nu + ct$ which is the location of the front, relative to the stationary stimulus. This gives $y' = \varepsilon \nu' + c$ and
\begin{align*}
    D\frac{y' - c}{\varepsilon} &= c \tau_u \left(1 - e^{-y^*/c\tau_u} e^{\frac{y}{c\tau_u}} \right) \\
    y' &= \underbrace{c + \frac{\varepsilon c\tau_u}{D}}_{a} - \underbrace{\frac{\varepsilon c\tau_u}{D}e^{-y^*}}_{b} e^{y/\underbrace{c\tau_u}_{r}} \\
        &= a - b e^{y/r}.
\end{align*}
</p>

<p>
    We next solve this differential equation with the following change of variables $u = e^{-y/r}$. This gives $u' = -\frac{1}{r}y'u \iff -r \frac{u'}{u} = y'$. Substituting,
\begin{align*}
    -r\frac{u'}{u} &= a - \frac{b}{u} \\
    u' &= \frac{b}{r} - \frac{a}{r}u \\
    u' +\frac{a}{r}u &= \frac{b}{r} \\
    \left[ u e^{at/r} \right]' &= \frac{b}{r}e^{at/r} \\
    u e^{at/r} &= u_0 + \int_{0}^t \frac{b}{r}e^{a\tau/r} \ d\tau \\
    u e^{at/r} &= u_0 + \frac{b}{a}\left( e^{at/r} - 1\right) \\
    u(t) &= \frac{b}{a} + \left(u_0 - \frac{b}{a} \right)e^{-at/r} \\
    e^{-y/r} &= \frac{b}{a} + \left(e^{-y_0/r} - \frac{b}{a} \right)e^{-at/r} \\
    y(t) &= -r \log\left[ \frac{b}{a} + \left(e^{-y_0/r} - \frac{b}{a} \right)e^{-at/r} \right] \\
		&= -r \log\left[ e^{-(y_0 - at)/r} + (1 - e^{-at/r})\frac{b}{a} \right] \\
\end{align*}
</p>

<p>
By our convention, $y_0 = 0$ at the beginning of each period, and $y^*$ changes so that the stimulus location is given relative to the threshold crossing. Entrainment then looks like $y^*$ being fixed from period to period. Our expression then simplifies to
$$
y(t) = -c\tau_u \log\left[ \exp\left(-\frac{D + \varepsilon \tau_u}{D\tau_u} t\right) + \left(1 - \exp\left(-\frac{D + \varepsilon \tau_u}{D\tau_u} t \right)\right)\frac{\varepsilon \tau_u}{D + \varepsilon \tau_u}e^{-y^*/c\tau_u}  \right].
$$
During $t \in (T_\text{on}, T)$, the formula is much simpler, since $\nu' = 0 \iff y' = c$. This gives
$$
y(t) = \begin{cases}
	-c\tau_u \log\left[ \exp\left(-\frac{D + \varepsilon \tau_u}{D\tau_u} t\right) + \left(1 - \exp\left(-\frac{D + \varepsilon \tau_u}{D\tau_u} t \right)\right)\frac{\varepsilon \tau_u}{D + \varepsilon \tau_u}e^{-y^*/c\tau_u}  \right] ,& t \in [0, T_\text{on}] \\
	y(T_{\text{on}}) + c(t - T_\text{on}) ,& t \in (t_\text{on}, T)
\end{cases}
$$

After a full period we have
$$
y(T) = -c\tau_u \log\left[ \exp\left(-\frac{D + \varepsilon \tau_u}{D\tau_u} T_\text{on}\right) + \left(1 - \exp\left(-\frac{D + \varepsilon \tau_u}{D\tau_u} T_\text{on} \right)\right)\frac{\varepsilon \tau_u}{D + \varepsilon \tau_u}e^{-y^*/c\tau_u}  \right] + c T_\text{off}.
$$
</p>

<p>
We are interested in fixed points of the mapping
$$\begin{align*}
F(y^*) &= y(T) - (c+\Delta_c)T \\
	&= -c\tau_u \log\left[ \underbrace{\exp\left(-\frac{D + \varepsilon \tau_u}{D\tau_u} T_\text{on}\right)}_{a} + \underbrace{\left(1 - \exp\left(-\frac{D + \varepsilon \tau_u}{D\tau_u} T_\text{on} \right)\right)\frac{\varepsilon \tau_u}{D + \varepsilon \tau_u}}_{b} e^{-y^*/c\tau_u}  \right] + \underbrace{c T_\text{off} - (c+\Delta_c)T}_{K}.
\end{align*}$$
</p>

<p>
We have
$$\begin{align*}
y^* &= F(y^*) \\
	&= -c\tau_u \log\left[ a + b e^{-y^*/c\tau_u}  \right] + K \\
\frac{-y^*}{c\tau_u} + \frac{K}{c\tau_u} 
	&= \log\left[ a + b e^{-y^*/c\tau_u}  \right] \\
e^{-y^*/c\tau_u} e^{K/c\tau_u} &= a + b e^{-y^*/c\tau_u} \\
e^{-y^*/c\tau_u} &= \frac{a}{e^{K/c\tau_u} - b} \\
y^* &= -c\tau_u \log\left[ \frac{a}{e^{K/c\tau_u} - b} \right].
\end{align*}$$
Before proceeding we note that
$$\begin{align*}
F'(y^*) &= e^{-y^*/c\tau_u} \frac{1}{a + b e^{-y^*/c\tau_u}} \\
	&= \frac{a}{e^{K/c\tau_u} - b} \frac{1}{a + b \frac{a}{e^{K/c\tau_u} - b}} \\
	&= \frac{a}{a(e^{K/c\tau_u} - b) + ab} \\
	&= e^{-K/c\tau_u} \\
|F'(y^*)| &\lt 1
\end{align*}$$
and thus fixed point iteration will always converge to $y^*$ regardless of parameter choices, provided that $y^*$ exists and the conditions for this case are met at each iteration.
</p>

<p>
We note that $a \gt 0$ and thus $y^*$ will exist if
\begin{align*}
	e^{K/c\tau_u} & \gt b \\
		&= \left(1 - \exp\left(-\frac{D + \varepsilon \tau_u}{D\tau_u} T \right)\right)\frac{\varepsilon \tau_u}{D + \varepsilon \tau_u} \\
	K & \gt c\tau_u \log\left[ \left(1 - \exp\left(-\frac{D + \varepsilon \tau_u}{D\tau_u} T \right)\right)\frac{\varepsilon \tau_u}{D + \varepsilon \tau_u} \right] \\
	-cT_\text{off} - \Delta_c T & \gt c\tau_u \log\left[ \left(1 - \exp\left(-\frac{D + \varepsilon \tau_u}{D\tau_u} T \right)\right)\frac{\varepsilon \tau_u}{D + \varepsilon \tau_u} \right] \\
	\Delta_c & \lt \frac{c\tau_u \log\left[ \left(1 - \exp\left(-\frac{D + \varepsilon \tau_u}{D\tau_u} T \right)\right)\frac{\varepsilon \tau_u}{D + \varepsilon \tau_u} \right] +cT_\text{off} }{-T}.
\end{align*}
</p>

<p>
This case is only valid if $y^* \lt \Delta_y$, otherwise, it could be the case that the threshold crossing is completely behind the stimulus for some portion of the on-interval, but catches up before the stimulus turns off. This can occur if $T$ is large even for slow $\Delta_c$.
$$\begin{align*}
	\Delta_y &\gt y^* \\
		&= -c\tau_u \log\left[ \frac{a}{e^{K/c\tau_u} - b} \right] \\
	e^{-\Delta_y / c\tau_u} &\lt \frac{a}{e^{K/c\tau_u} - b} \\
	e^{K/c\tau_u} - b &\lt ae^{\Delta_y/c\tau_u} \\
	K &\lt c\tau_u \log\left[ b + a e^{\Delta_y/c\tau_u} \right] \\
	-\Delta_cT - cT_\text{off} &\le c\tau_u \log\left[ b + a e^{\Delta_y/c\tau_u} \right] \\
	\Delta_c & \gt \frac{c T_\text{off} + c\tau_u \log\left[ b + a e^{\Delta_y/c\tau_u} \right] }{-T}.
\end{align*}$$
</p>

<h3>Inconsistencies</h3>
<p>
There is one features of this result that casts some doubt on it's correctness. Specifically, it is the behaviour as $\Delta_c \to 0$. At this extreme, one would expect the bound to also go to zero as $\varepsilon \to 0$. That is, by definition, a pulse is always entrained to a stimulus of magnitude zero that is moving at the same speed. But for a stimulus moving faster than the pulse, there will always be a magnitude small enough such that the pulse will fail to entrain. 
</p>

<p>
I'm not certain where the error is, but I believe that the convention of $y_0 = 0$ at each iteration is inconsistent with the shift $(c + \Delta_c)T$ at each period. I think at least one of these is inconsistent with the choice of reference frame. If the reference frame is the jumping stimulus, then $y_0 \mapsto y(T) - (c+\Delta_c)T \ne 0$. If the reference frame is the defined such that $y_0 = 0$ and the frame is not moving, then our reference frame is not shifting by $(c+\Delta_c)T$ at each jump (as assumed in the construction of $F$ above). 
</p>

<p>
I think the simplest solution is to choose the reference frame of the stimulus at each jump. In this case, $y^*$ remains fixed and we will be iterating on $y_0$. This should salvage most of the work so far. We'll need to slightly modify our formula for $y(t)$ to not assume $y_0 = 0$ and then recalculate the fixed point of the same mapping, but with respect to $y_0$ rather than $y^*$ and also the stability calculation for that fixed point.
</p>

<h2>Case 2: Long Periods</h2>
<p>
Lorem
</p>


<!--***************************************************************************
*******************************************************************************
****************************************************************************-->
</div>

<!-- Accordion script -->
<script>
var acc = document.getElementsByClassName("accordion");
var i;

for (i = 0; i < acc.length; i++) {
  acc[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var panel = this.nextElementSibling;
    if (panel.style.display === "block") {
      panel.style.display = "none";
    } else {
      panel.style.display = "block";
    }
  });

var expand_all_accordions = true;

if (expand_all_accordions){
    for (i = 0; i < acc.length; i++) {
      acc[i].nextElementSibling.style.display = "block";
    }
}

}
</script>

<!-- Tabs script -->
<script>
function openTab(evt, tabId) {
  // Declare all variables
  var i, tabcontent, tablinks;

  // Get all elements with class="tabcontent" and hide them
  tabcontent = document.getElementsByClassName("tabcontent");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }

  // Get all elements with class="tablinks" and remove the class "active"
  tablinks = document.getElementsByClassName("tablinks");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }

  // Show the current tab, and add an "active" class to the button that opened the tab
  document.getElementById(tabId).style.display = "block";
  evt.currentTarget.className += " active";
}
</script>

</body>
    
</html>
